{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:////bundle.js","webpack:///webpack/bootstrap e3dec9545ab1fa9a5bb7","webpack:///./src/index.js","webpack:///./src/locator.js","webpack:///external \"three\"","webpack:///./src/gridCalculator.js","webpack:///./src/models/BaseObject.js","webpack:///./src/cache.js","webpack:///./src/repository.js","webpack:///./src/environment.js","webpack:///./src/materials/BookMaterial.js","webpack:///./src/materials/shaders/BookMaterial.vs","webpack:///./src/materials/shaders/BookMaterial.fs","webpack:///./src/models/LibraryObject.js","webpack:///./src/models/BookObject.js","webpack:///./src/models/SectionObject.js","webpack:///./src/models/ShelfObject.js","webpack:///./src/camera.js","webpack:///./src/models/CameraObject.js","webpack:///./src/mouse.js","webpack:///./src/preview.js","webpack:///./src/highlight.js","webpack:///./src/img/glow.png","webpack:///./src/selector.js","webpack:///./src/models/SelectorMeta.js","webpack:///./src/navigation.js","webpack:///./src/models/SelectorMetaDto.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_2__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","init","canvas","width","height","renderer","_three2","WebGLRenderer","undefined","antialias","setSize","_environment2","scene","Scene","fog","Fog","startRenderLoop","addLoop","func","loops","push","load","dto","loadLibrary","requestAnimationFrame","render","_camera2","camera","forEach","Object","defineProperty","value","environment","SelectorMetaDto","SelectorMeta","SectionObject","BookObject","ShelfObject","navigation","selector","preview","mouse","locator","_locator","enumerable","get","_mouse","_preview","_selector","_navigation","_ShelfObject","_BookObject","_SectionObject","_SelectorMeta","_SelectorMetaDto","_three","_camera","_environment","_interopRequireWildcard","newObj","key","prototype","hasOwnProperty","getFreePlace","objects","spaceBB","targetBB","matrixPrecision","Vector3","max","x","min","z","occupiedMatrix","getOccupiedMatrix","freePosition","getFreeMatrixCells","debugEnabled","debugShowFree","library","getFreeMatrix","xIndex","zIndex","DISTANCE","position","minPosition","edges","_gridCalculator2","getEdges","minZCell","maxZCell","minXCell","maxXCell","pos","getPositionFromCells","length","freeCellsStart","cells","targetCellsSize","freeCellsCount","_","range","center","cellToPos","offset","addVectors","multiplyScalar","add","setY","getBottomY","y","CLEARANCE","objectBB","minKeyX","maxKeyX","minKeyZ","maxKeyZ","result","child","_BaseObject2","boundingBox","Math","round","radius","debugCells","debugShowBB","debugAddOccupied","objBox","Mesh","BoxGeometry","MeshLambertMaterial","color","opacity","transparent","parent","zKey","cell","geometry","cellBox","set","_gridCalculator","_BaseObject","_cache","cache","centerObject","children","setX","setZ","placeSection","sectionDto","getSection","model","then","sectionCache","sectionBB","libraryBB","freePlace","Promise","resolve","reject","placeBook","bookDto","shelf","getBook","bookCache","shelfBB","bookBB","debug","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","descriptor","configurable","writable","protoProps","staticProps","GridCalculator","precision","posMin","posToCell","posMax","clone","divide","multiply","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","BaseObject","_THREE$Mesh","dataObject","material","_this","getPrototypeOf","rotation","order","setDtoTransformations","vbType","pos_x","pos_y","pos_z","fromArray","map","Number","updateBoundingBox","abs","targets","isOutOfParrent","newPosition","currentPosition","isCollided","changed","dX","dY","isDemo","currentRotation","updateMatrix","applyMatrix4","matrix","libraryModel","sectionModels","bookModels","libraryLoad","repository","loadLibraryData","sectionsLoad","booksLoad","addSection","addBook","all","results","getLibrary","commonGetter","sections","books","commonAdder","loadSectionData","loadBookData","from","addFunction","where","what","loader","promise","loadedCache","_repository","path","modelUrl","mapUrl","loadGeometry","loadImage","mapImage","dataUrl","loadData","sectionData","data","bumpMapUrl","specularMapUrl","console","error","bumpMapImage","specularMapImage","url","jsonLoader","computeBoundingBox","img","Image","crossOrigin","src","onload","onerror","err","dataLoader","JSONLoader","XHRLoader","setResponseType","removeObject","dict","dictItem","setParent","initCache","libraryDto","sectionsDict","booksDict","sectionId","bookId","clearScene","dispose","remove","parseLibraryDto","sectionIndex","bookIndex","createLibrary","libraryCache","texture","Texture","MeshPhongMaterial","needsUpdate","_LibraryObject2","AmbientLight","createSections","createObjects","createSection","createBooks","createBook","section","_SectionObject2","addToDict","cover","coverMapImage","_BookMaterial2","book","_BookObject2","placeBookOnShelf","getId","getDictObject","objectId","dictObject","getBookShelf","getShelf","shelfId","_BookMaterial","_LibraryObject","object","shelves","updateSection","libraryId","removeSection","updateBook","removeBook","vertexShader","fragmentShader","BookMaterial","_THREE$ShaderMaterial","uniforms","parameters","bumpMap","specularMap","coverMap","defines","UniformsUtils","merge","UniformsLib","common","bump","lights","shininess","type","PHONG","bumpScale","specular","Color","USE_COVER","ShaderMaterial","_BaseObject3","LibraryObject","params","TYPE","userId","_ShelfObject2","size","_CameraObject","_CameraObject2","HEIGTH","getPosition","PerspectiveCamera","candle","PointLight","rotate","newX","newY","go","speed","direction","getVector","move","vector","applyEuler","CameraObject","Geometry","Box3","getWidth","window","innerWidth","getHeight","innerHeight","unproject","sub","normalize","longX","longY","getTarget","down","event","which","clientX","clientY","up","getIntersected","recursive","searchFor","raycaster","intersects","intersected","j","Raycaster","intersectObjects","container","Object3D","activate","active","_highlight2","enable","clearContainer","_highlight","isActive","objClone","disable","selectPlane","focusPlane","highlight","PLANE_ROTATION","PI","PLANE_MULTIPLIER","COLOR_SELECT","COLOR_FOCUS","materialProperties","ImageUtils","loadTexture","side","DoubleSide","blending","AdditiveBlending","depthTest","materialSelect","MeshBasicMaterial","materialFocus","PlaneBufferGeometry","commonHighlight","bottom","scale","visible","focus","select","getObject","meta","isEmpty","isShelf","parentId","isBook","isSection","_SelectorMeta2","selected","focused","placing","getSelectedId","equals","getFocusedObject","selectFocused","unselect","getSelectedObject","isSelectedEditable","isSelectedBook","isSelectedSection","isBookSelected","isSelectedShelf","selectedObject","getType","BUTTONS_ROTATE_SPEED","BUTTONS_GO_SPEED","state","forward","backward","left","right","goStop","goForward","goBackward","goLeft","goRight","update","_SelectorMeta3"],"mappings":"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","file":"/bundle.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"three\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"three\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"lib3d\"] = factory(require(\"three\"));\n\telse\n\t\troot[\"lib3d\"] = factory(root[\"three\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"three\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"three\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"lib3d\"] = factory(require(\"three\"));\n\telse\n\t\troot[\"lib3d\"] = factory(root[\"three\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/dist\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/*!**********************!*\\\n  !*** ./src/index.js ***!\n  \\**********************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.environment = exports.camera = exports.renderer = exports.SelectorMetaDto = exports.SelectorMeta = exports.SectionObject = exports.BookObject = exports.ShelfObject = exports.navigation = exports.selector = exports.preview = exports.mouse = exports.locator = undefined;\n\t\n\tvar _locator = __webpack_require__(/*! ./locator */ 1);\n\t\n\tObject.defineProperty(exports, 'locator', {\n\t\tenumerable: true,\n\t\tget: function get() {\n\t\t\treturn _locator.locator;\n\t\t}\n\t});\n\t\n\tvar _mouse = __webpack_require__(/*! ./mouse */ 17);\n\t\n\tObject.defineProperty(exports, 'mouse', {\n\t\tenumerable: true,\n\t\tget: function get() {\n\t\t\treturn _mouse.mouse;\n\t\t}\n\t});\n\t\n\tvar _preview = __webpack_require__(/*! ./preview */ 18);\n\t\n\tObject.defineProperty(exports, 'preview', {\n\t\tenumerable: true,\n\t\tget: function get() {\n\t\t\treturn _preview.preview;\n\t\t}\n\t});\n\t\n\tvar _selector = __webpack_require__(/*! ./selector */ 21);\n\t\n\tObject.defineProperty(exports, 'selector', {\n\t\tenumerable: true,\n\t\tget: function get() {\n\t\t\treturn _selector.selector;\n\t\t}\n\t});\n\t\n\tvar _navigation = __webpack_require__(/*! ./navigation */ 23);\n\t\n\tObject.defineProperty(exports, 'navigation', {\n\t\tenumerable: true,\n\t\tget: function get() {\n\t\t\treturn _navigation.navigation;\n\t\t}\n\t});\n\t\n\tvar _ShelfObject = __webpack_require__(/*! ./models/ShelfObject */ 14);\n\t\n\tObject.defineProperty(exports, 'ShelfObject', {\n\t\tenumerable: true,\n\t\tget: function get() {\n\t\t\treturn _ShelfObject.default;\n\t\t}\n\t});\n\t\n\tvar _BookObject = __webpack_require__(/*! ./models/BookObject */ 12);\n\t\n\tObject.defineProperty(exports, 'BookObject', {\n\t\tenumerable: true,\n\t\tget: function get() {\n\t\t\treturn _BookObject.default;\n\t\t}\n\t});\n\t\n\tvar _SectionObject = __webpack_require__(/*! ./models/SectionObject */ 13);\n\t\n\tObject.defineProperty(exports, 'SectionObject', {\n\t\tenumerable: true,\n\t\tget: function get() {\n\t\t\treturn _SectionObject.default;\n\t\t}\n\t});\n\t\n\tvar _SelectorMeta = __webpack_require__(/*! ./models/SelectorMeta */ 22);\n\t\n\tObject.defineProperty(exports, 'SelectorMeta', {\n\t\tenumerable: true,\n\t\tget: function get() {\n\t\t\treturn _SelectorMeta.default;\n\t\t}\n\t});\n\t\n\tvar _SelectorMetaDto = __webpack_require__(/*! ./models/SelectorMetaDto */ 24);\n\t\n\tObject.defineProperty(exports, 'SelectorMetaDto', {\n\t\tenumerable: true,\n\t\tget: function get() {\n\t\t\treturn _SelectorMetaDto.default;\n\t\t}\n\t});\n\texports.init = init;\n\texports.addLoop = addLoop;\n\texports.load = load;\n\t\n\tvar _three = __webpack_require__(/*! three */ 2);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _camera = __webpack_require__(/*! ./camera */ 15);\n\t\n\tvar _camera2 = _interopRequireDefault(_camera);\n\t\n\tvar _environment = __webpack_require__(/*! ./environment */ 7);\n\t\n\tvar _environment2 = _interopRequireDefault(_environment);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar loops = [];\n\tvar renderer = exports.renderer = undefined;\n\t\n\t/**\n\t * Inits lib3d, should be called first\n\t * @param {canvas} canvas - chould be provided for lib3d output\n\t */\n\tfunction init(canvas, width, height) {\n\t\texports.renderer = renderer = new _three2.default.WebGLRenderer({ canvas: canvas || undefined, antialias: true });\n\t\trenderer.setSize(width, height);\n\t\n\t\t_environment2.default.scene = new _three2.default.Scene();\n\t\t_environment2.default.scene.fog = new _three2.default.Fog(0x000000, 4, 7);\n\t\n\t\tstartRenderLoop();\n\t}\n\t\n\t/**\n\t * Adds function to render loop\n\t * @param {function} func - function will be called on every render call\n\t */\n\tfunction addLoop(func) {\n\t\tloops.push(func);\n\t}\n\t\n\t//TODO: make separate loader module\n\t/**\n\t * Loads library by an object\n\t * @param {object} dto - full library structure\n\t */\n\tfunction load(dto) {\n\t\treturn _environment2.default.loadLibrary(dto);\n\t}\n\t\n\tfunction startRenderLoop() {\n\t\trequestAnimationFrame(startRenderLoop);\n\t\trenderer.render(_environment2.default.scene, _camera2.default.camera);\n\t\n\t\tloops.forEach(function (func) {\n\t\t\treturn func();\n\t\t});\n\t}\n\t\n\texports.camera = _camera2.default;\n\texports.environment = _environment2.default;\n\n/***/ },\n/* 1 */\n/*!************************!*\\\n  !*** ./src/locator.js ***!\n  \\************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.locator = undefined;\n\t\n\tvar _three = __webpack_require__(/*! three */ 2);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _gridCalculator = __webpack_require__(/*! ./gridCalculator */ 3);\n\t\n\tvar _gridCalculator2 = _interopRequireDefault(_gridCalculator);\n\t\n\tvar _BaseObject = __webpack_require__(/*! ./models/BaseObject */ 4);\n\t\n\tvar _BaseObject2 = _interopRequireDefault(_BaseObject);\n\t\n\tvar _cache = __webpack_require__(/*! ./cache */ 5);\n\t\n\tvar cache = _interopRequireWildcard(_cache);\n\t\n\tvar _environment = __webpack_require__(/*! ./environment */ 7);\n\t\n\tvar _environment2 = _interopRequireDefault(_environment);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar locator = exports.locator = {};\n\t\n\tvar debugEnabled = false;\n\t\n\tlocator.centerObject = function (obj) {\n\t\tvar targetBB = obj.geometry.boundingBox;\n\t\tvar spaceBB = _environment2.default.library.geometry.boundingBox;\n\t\n\t\tvar matrixPrecision = new _three2.default.Vector3(targetBB.max.x - targetBB.min.x + 0.01, 0, targetBB.max.z - targetBB.min.z + 0.01);\n\t\tvar occupiedMatrix = getOccupiedMatrix(_environment2.default.library.children, matrixPrecision, obj);\n\t\tvar freePosition = getFreeMatrix(occupiedMatrix, spaceBB, targetBB, matrixPrecision);\n\t\n\t\tobj.position.setX(freePosition.x);\n\t\tobj.position.setZ(freePosition.z);\n\t};\n\t\n\tlocator.placeSection = function (sectionDto) {\n\t\treturn cache.getSection(sectionDto.model).then(function (sectionCache) {\n\t\t\tvar sectionBB = sectionCache.geometry.boundingBox;\n\t\t\tvar libraryBB = _environment2.default.library.geometry.boundingBox;\n\t\t\tvar freePlace = getFreePlace(_environment2.default.library.children, libraryBB, sectionBB);\n\t\n\t\t\tif (freePlace) {\n\t\t\t\treturn Promise.resolve(freePlace);\n\t\t\t} else {\n\t\t\t\treturn Promise.reject('there is no free space');\n\t\t\t}\n\t\t});\n\t};\n\t\n\tlocator.placeBook = function (bookDto, shelf) {\n\t\treturn cache.getBook(bookDto.model).then(function (bookCache) {\n\t\t\tvar shelfBB = shelf.geometry.boundingBox;\n\t\t\tvar bookBB = bookCache.geometry.boundingBox;\n\t\t\tvar freePlace = getFreePlace(shelf.children, shelfBB, bookBB);\n\t\n\t\t\treturn freePlace ? Promise.resolve(freePlace) : Promise.reject('there is no free space');\n\t\t});\n\t};\n\t\n\tfunction getFreePlace(objects, spaceBB, targetBB) {\n\t\tvar matrixPrecision = new _three2.default.Vector3(targetBB.max.x - targetBB.min.x + 0.01, 0, targetBB.max.z - targetBB.min.z + 0.01);\n\t\tvar occupiedMatrix = getOccupiedMatrix(objects, matrixPrecision);\n\t\tvar freePosition = getFreeMatrixCells(occupiedMatrix, spaceBB, targetBB, matrixPrecision);\n\t\n\t\tif (debugEnabled) {\n\t\t\tdebugShowFree(freePosition, matrixPrecision, _environment2.default.library);\n\t\t}\n\t\n\t\treturn freePosition;\n\t}\n\t\n\tfunction getFreeMatrix(occupiedMatrix, spaceBB, targetBB, matrixPrecision) {\n\t\tvar DISTANCE = 1.3;\n\t\n\t\tvar xIndex;\n\t\tvar zIndex;\n\t\tvar position = {};\n\t\tvar minPosition = {};\n\t\tvar edges = _gridCalculator2.default.getEdges(spaceBB, matrixPrecision);\n\t\n\t\tfor (zIndex = edges.minZCell; zIndex <= edges.maxZCell; zIndex++) {\n\t\t\tfor (xIndex = edges.minXCell; xIndex <= edges.maxXCell; xIndex++) {\n\t\t\t\tif (!occupiedMatrix[zIndex] || !occupiedMatrix[zIndex][xIndex]) {\n\t\t\t\t\tposition.pos = getPositionFromCells([xIndex], zIndex, matrixPrecision, spaceBB, targetBB);\n\t\t\t\t\tposition.length = position.pos.length();\n\t\n\t\t\t\t\tif (!minPosition.pos || position.length < minPosition.length) {\n\t\t\t\t\t\tminPosition.pos = position.pos;\n\t\t\t\t\t\tminPosition.length = position.length;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (minPosition.pos && minPosition.length < DISTANCE) {\n\t\t\t\t\t\treturn minPosition.pos;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\treturn minPosition.pos;\n\t}\n\t\n\tfunction getFreeMatrixCells(occupiedMatrix, spaceBB, targetBB, matrixPrecision) {\n\t\tvar targetCellsSize = 1;\n\t\tvar freeCellsCount = 0;\n\t\tvar freeCellsStart;\n\t\tvar xIndex;\n\t\tvar zIndex;\n\t\tvar cells;\n\t\tvar edges = _gridCalculator2.default.getEdges(spaceBB, matrixPrecision);\n\t\n\t\tfor (zIndex = edges.minZCell; zIndex <= edges.maxZCell; zIndex++) {\n\t\t\tfor (xIndex = edges.minXCell; xIndex <= edges.maxXCell; xIndex++) {\n\t\t\t\tif (!occupiedMatrix[zIndex] || !occupiedMatrix[zIndex][xIndex]) {\n\t\t\t\t\tfreeCellsStart = freeCellsStart || xIndex;\n\t\t\t\t\tfreeCellsCount++;\n\t\n\t\t\t\t\tif (freeCellsCount === targetCellsSize) {\n\t\t\t\t\t\tcells = _.range(freeCellsStart, freeCellsStart + freeCellsCount);\n\t\t\t\t\t\treturn getPositionFromCells(cells, zIndex, matrixPrecision, spaceBB, targetBB);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfreeCellsCount = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\treturn null;\n\t}\n\t\n\tfunction getPositionFromCells(cells, zIndex, matrixPrecision, spaceBB, targetBB) {\n\t\tvar center = _gridCalculator2.default.cellToPos(new _three2.default.Vector3(cells[0], 0, zIndex), matrixPrecision);\n\t\n\t\tvar offset = new _three2.default.Vector3();\n\t\toffset.addVectors(targetBB.min, targetBB.max);\n\t\toffset.multiplyScalar(-0.5);\n\t\n\t\treturn center.add(offset).setY(getBottomY(spaceBB, targetBB));\n\t}\n\t\n\tfunction getBottomY(spaceBB, targetBB) {\n\t\treturn spaceBB.min.y - targetBB.min.y + _environment2.default.CLEARANCE;\n\t}\n\t\n\tfunction getOccupiedMatrix(objects, matrixPrecision, obj) {\n\t\tvar result = {};\n\t\tvar objectBB;\n\t\tvar minKeyX;\n\t\tvar maxKeyX;\n\t\tvar minKeyZ;\n\t\tvar maxKeyZ;\n\t\tvar z, x;\n\t\n\t\tobjects.forEach(function (child) {\n\t\t\tif (child instanceof _BaseObject2.default && child !== obj) {\n\t\t\t\tobjectBB = child.boundingBox;\n\t\n\t\t\t\tminKeyX = Math.round((objectBB.center.x - objectBB.radius.x) / matrixPrecision.x);\n\t\t\t\tmaxKeyX = Math.round((objectBB.center.x + objectBB.radius.x) / matrixPrecision.x);\n\t\t\t\tminKeyZ = Math.round((objectBB.center.z - objectBB.radius.z) / matrixPrecision.z);\n\t\t\t\tmaxKeyZ = Math.round((objectBB.center.z + objectBB.radius.z) / matrixPrecision.z);\n\t\n\t\t\t\tfor (z = minKeyZ; z <= maxKeyZ; z++) {\n\t\t\t\t\tresult[z] = result[z] || {};\n\t\t\t\t\tvar debugCells = [];\n\t\n\t\t\t\t\tfor (x = minKeyX; x <= maxKeyX; x++) {\n\t\t\t\t\t\tresult[z][x] = true;\n\t\t\t\t\t\tdebugCells.push(x);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (debugEnabled) {\n\t\t\t\t\t\tdebugShowBB(child);\n\t\t\t\t\t\tdebugAddOccupied(debugCells, matrixPrecision, child, z);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\treturn result;\n\t}\n\t\n\tlocator.debug = function () {\n\t\tcache.getSection('bookshelf_0001').then(function (sectionCache) {\n\t\t\tdebugEnabled = true;\n\t\t\tvar sectionBB = sectionCache.geometry.boundingBox;\n\t\t\tvar libraryBB = _environment2.default.library.geometry.boundingBox;\n\t\t\tgetFreePlace(_environment2.default.library.children, libraryBB, sectionBB);\n\t\t\tdebugEnabled = false;\n\t\t});\n\t};\n\t\n\tfunction debugShowBB(obj) {\n\t\tvar objectBB = obj.boundingBox;\n\t\tvar objBox = new _three2.default.Mesh(new _three2.default.BoxGeometry(objectBB.radius.x * 2, objectBB.radius.y * 2 + 0.1, objectBB.radius.z * 2), new _three2.default.MeshLambertMaterial({\n\t\t\tcolor: 0xbbbbff,\n\t\t\topacity: 0.2,\n\t\t\ttransparent: true\n\t\t}));\n\t\n\t\tobjBox.position.x = objectBB.center.x;\n\t\tobjBox.position.y = objectBB.center.y;\n\t\tobjBox.position.z = objectBB.center.z;\n\t\n\t\tobj.parent.add(objBox);\n\t}\n\t\n\tfunction debugAddOccupied(cells, matrixPrecision, obj, zKey) {\n\t\tcells.forEach(function (cell) {\n\t\t\tvar pos = getPositionFromCells([cell], zKey, matrixPrecision, obj.parent.geometry.boundingBox, obj.geometry.boundingBox);\n\t\t\tvar cellBox = new _three2.default.Mesh(new _three2.default.BoxGeometry(matrixPrecision.x - 0.01, 0.01, matrixPrecision.z - 0.01), new _three2.default.MeshLambertMaterial({ color: 0xff0000 }));\n\t\n\t\t\tcellBox.position.set(pos.x, pos.y, pos.z);\n\t\t\tobj.parent.add(cellBox);\n\t\t});\n\t}\n\t\n\tfunction debugShowFree(position, matrixPrecision, obj) {\n\t\tif (position) {\n\t\t\tvar cellBox = new _three2.default.Mesh(new _three2.default.BoxGeometry(matrixPrecision.x, 0.5, matrixPrecision.z), new _three2.default.MeshLambertMaterial({ color: 0x00ff00 }));\n\t\t\tcellBox.position.set(position.x, position.y, position.z);\n\t\t\tobj.parent.add(cellBox);\n\t\t}\n\t}\n\n/***/ },\n/* 2 */\n/*!************************!*\\\n  !*** external \"three\" ***!\n  \\************************/\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n/***/ },\n/* 3 */\n/*!*******************************!*\\\n  !*** ./src/gridCalculator.js ***!\n  \\*******************************/\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar GridCalculator = (function () {\n\t\tfunction GridCalculator() {\n\t\t\t_classCallCheck(this, GridCalculator);\n\t\t}\n\t\n\t\t_createClass(GridCalculator, null, [{\n\t\t\tkey: \"getEdges\",\n\t\t\tvalue: function getEdges(spaceBB, precision) {\n\t\t\t\tvar posMin = this.posToCell(spaceBB.min, precision);\n\t\t\t\tvar posMax = this.posToCell(spaceBB.max, precision);\n\t\n\t\t\t\treturn {\n\t\t\t\t\tminXCell: posMin.x + 1,\n\t\t\t\t\tmaxXCell: posMax.x - 1,\n\t\t\t\t\tminZCell: posMin.z + 1,\n\t\t\t\t\tmaxZCell: posMax.z - 1\n\t\t\t\t};\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"posToCell\",\n\t\t\tvalue: function posToCell(pos, precision) {\n\t\t\t\treturn pos.clone().divide(precision).round();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"cellToPos\",\n\t\t\tvalue: function cellToPos(cell, precision) {\n\t\t\t\treturn cell.clone().multiply(precision);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn GridCalculator;\n\t})();\n\t\n\texports.default = GridCalculator;\n\n/***/ },\n/* 4 */\n/*!**********************************!*\\\n  !*** ./src/models/BaseObject.js ***!\n  \\**********************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _three = __webpack_require__(/*! three */ 2);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar BaseObject = (function (_THREE$Mesh) {\n\t\t_inherits(BaseObject, _THREE$Mesh);\n\t\n\t\tfunction BaseObject(dataObject, geometry, material) {\n\t\t\t_classCallCheck(this, BaseObject);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(BaseObject).call(this, geometry, material));\n\t\n\t\t\t_this.dataObject = dataObject || {};\n\t\t\t_this.rotation.order = 'XYZ';\n\t\t\t_this.setDtoTransformations();\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(BaseObject, [{\n\t\t\tkey: 'getType',\n\t\t\tvalue: function getType() {\n\t\t\t\treturn this.vbType;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'getId',\n\t\t\tvalue: function getId() {\n\t\t\t\treturn this.dataObject && this.dataObject.id;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'setDtoTransformations',\n\t\t\tvalue: function setDtoTransformations() {\n\t\t\t\tthis.position.setX(this.dataObject.pos_x || 0);\n\t\t\t\tthis.position.setY(this.dataObject.pos_y || 0);\n\t\t\t\tthis.position.setZ(this.dataObject.pos_z || 0);\n\t\n\t\t\t\tif (this.dataObject.rotation) this.rotation.fromArray(this.dataObject.rotation.map(Number));\n\t\n\t\t\t\tthis.updateBoundingBox();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'isOutOfParrent',\n\t\t\tvalue: function isOutOfParrent() {\n\t\t\t\treturn Math.abs(this.boundingBox.center.x - this.parent.boundingBox.center.x) > this.parent.boundingBox.radius.x - this.boundingBox.radius.x || Math.abs(this.boundingBox.center.z - this.parent.boundingBox.center.z) > this.parent.boundingBox.radius.z - this.boundingBox.radius.z;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'isCollided',\n\t\t\tvalue: function isCollided() {\n\t\t\t\tvar result, targets, target, i;\n\t\n\t\t\t\tthis.updateBoundingBox();\n\t\n\t\t\t\tresult = this.isOutOfParrent();\n\t\t\t\ttargets = this.parent.children;\n\t\n\t\t\t\tif (!result) {\n\t\t\t\t\tfor (i = targets.length - 1; i >= 0; i--) {\n\t\t\t\t\t\ttarget = targets[i].boundingBox;\n\t\n\t\t\t\t\t\tif (targets[i] === this || !target || // children without BB\n\t\t\t\t\t\tMath.abs(this.boundingBox.center.x - target.center.x) > this.boundingBox.radius.x + target.radius.x || Math.abs(this.boundingBox.center.y - target.center.y) > this.boundingBox.radius.y + target.radius.y || Math.abs(this.boundingBox.center.z - target.center.z) > this.boundingBox.radius.z + target.radius.z) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tresult = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'move',\n\t\t\tvalue: function move(newPosition) {\n\t\t\t\tvar currentPosition, result;\n\t\n\t\t\t\tresult = false;\n\t\t\t\tcurrentPosition = this.position.clone();\n\t\n\t\t\t\tif (newPosition.x) {\n\t\t\t\t\tthis.position.setX(newPosition.x);\n\t\n\t\t\t\t\tif (this.isCollided()) {\n\t\t\t\t\t\tthis.position.setX(currentPosition.x);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif (newPosition.z) {\n\t\t\t\t\tthis.position.setZ(newPosition.z);\n\t\n\t\t\t\t\tif (this.isCollided()) {\n\t\t\t\t\t\tthis.position.setZ(currentPosition.z);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tthis.changed = this.changed || result;\n\t\t\t\tthis.updateBoundingBox();\n\t\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'rotate',\n\t\t\tvalue: function rotate(dX, dY, isDemo) {\n\t\t\t\tvar currentRotation = this.rotation.clone(),\n\t\t\t\t    result = false;\n\t\n\t\t\t\tif (dX) {\n\t\t\t\t\tthis.rotation.y += dX * 0.01;\n\t\n\t\t\t\t\tif (!isDemo && this.isCollided()) {\n\t\t\t\t\t\tthis.rotation.y = currentRotation.y;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif (dY) {\n\t\t\t\t\tthis.rotation.x += dY * 0.01;\n\t\n\t\t\t\t\tif (!isDemo && this.isCollided()) {\n\t\t\t\t\t\tthis.rotation.x = currentRotation.x;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tthis.changed = this.changed || !isDemo && result;\n\t\t\t\tthis.updateBoundingBox();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'updateBoundingBox',\n\t\t\tvalue: function updateBoundingBox() {\n\t\t\t\tvar boundingBox, radius, center;\n\t\n\t\t\t\tthis.updateMatrix();\n\t\t\t\tboundingBox = this.geometry.boundingBox.clone().applyMatrix4(this.matrix);\n\t\n\t\t\t\tradius = {\n\t\t\t\t\tx: (boundingBox.max.x - boundingBox.min.x) * 0.5,\n\t\t\t\t\ty: (boundingBox.max.y - boundingBox.min.y) * 0.5,\n\t\t\t\t\tz: (boundingBox.max.z - boundingBox.min.z) * 0.5\n\t\t\t\t};\n\t\n\t\t\t\tcenter = new _three2.default.Vector3();\n\t\t\t\tcenter.addVectors(boundingBox.min, boundingBox.max);\n\t\t\t\tcenter.multiplyScalar(0.5);\n\t\n\t\t\t\tthis.boundingBox = {\n\t\t\t\t\tradius: radius,\n\t\t\t\t\tcenter: center\n\t\t\t\t};\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'rollback',\n\t\t\tvalue: function rollback() {\n\t\t\t\tthis.setDtoTransformations();\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn BaseObject;\n\t})(_three2.default.Mesh);\n\t\n\texports.default = BaseObject;\n\n/***/ },\n/* 5 */\n/*!**********************!*\\\n  !*** ./src/cache.js ***!\n  \\**********************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.init = init;\n\texports.getLibrary = getLibrary;\n\texports.getSection = getSection;\n\texports.getBook = getBook;\n\t\n\tvar _repository = __webpack_require__(/*! ./repository */ 6);\n\t\n\tvar repository = _interopRequireWildcard(_repository);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tvar library = null;\n\tvar sections = {};\n\tvar books = {};\n\t\n\tfunction init(libraryModel, sectionModels, bookModels) {\n\t\tvar libraryLoad = repository.loadLibraryData(libraryModel);\n\t\tvar sectionsLoad = [];\n\t\tvar booksLoad = [];\n\t\tvar model; // iterators\n\t\n\t\tfor (model in sectionModels) {\n\t\t\tsectionsLoad.push(addSection(model));\n\t\t}\n\t\n\t\tfor (model in bookModels) {\n\t\t\tbooksLoad.push(addBook(model));\n\t\t}\n\t\n\t\treturn Promise.all([libraryLoad, Promise.all(sectionsLoad), Promise.all(booksLoad)]).then(function (results) {\n\t\t\tlibrary = results[0];\n\t\t});\n\t}\n\t\n\tfunction getLibrary() {\n\t\treturn library;\n\t}\n\t\n\tfunction getSection(model) {\n\t\treturn commonGetter(sections, model, addSection);\n\t}\n\t\n\tfunction getBook(model) {\n\t\treturn commonGetter(books, model, addBook);\n\t}\n\t\n\tfunction addSection(model) {\n\t\treturn commonAdder(sections, model, repository.loadSectionData);\n\t}\n\t\n\tfunction addBook(model) {\n\t\treturn commonAdder(books, model, repository.loadBookData);\n\t}\n\t\n\tfunction commonGetter(from, key, addFunction) {\n\t\tvar result = from[key];\n\t\n\t\tif (!result) {\n\t\t\tresult = addFunction(key);\n\t\t}\n\t\n\t\treturn Promise.resolve(result);\n\t}\n\t\n\tfunction commonAdder(where, what, loader) {\n\t\tvar promise = loader(what).then(function (loadedCache) {\n\t\t\twhere[what] = loadedCache;\n\t\n\t\t\treturn loadedCache;\n\t\t});\n\t\n\t\treturn promise;\n\t}\n\n/***/ },\n/* 6 */\n/*!***************************!*\\\n  !*** ./src/repository.js ***!\n  \\***************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.loadLibraryData = loadLibraryData;\n\texports.loadSectionData = loadSectionData;\n\texports.loadBookData = loadBookData;\n\texports.loadImage = loadImage;\n\t\n\tvar _three = __webpack_require__(/*! three */ 2);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar jsonLoader = new _three2.default.JSONLoader();\n\tvar dataLoader = new _three2.default.XHRLoader();\n\tdataLoader.setResponseType('json');\n\t\n\tfunction loadLibraryData(model) {\n\t  var path = '/obj/libraries/' + model;\n\t  var modelUrl = path + '/model.json';\n\t  var mapUrl = path + '/map.jpg';\n\t\n\t  return Promise.all([loadGeometry(modelUrl), loadImage(mapUrl)]).then(function (results) {\n\t    return {\n\t      geometry: results[0],\n\t      mapImage: results[1]\n\t    };\n\t  });\n\t}\n\t\n\tfunction loadSectionData(model) {\n\t  var path = '/obj/sections/' + model;\n\t  var modelUrl = path + '/model.js';\n\t  var mapUrl = path + '/map.jpg';\n\t  var dataUrl = path + '/data.json';\n\t\n\t  return Promise.all([loadGeometry(modelUrl), loadImage(mapUrl), loadData(dataUrl)]).then(function (sectionData) {\n\t    return {\n\t      geometry: sectionData[0],\n\t      mapImage: sectionData[1],\n\t      data: sectionData[2]\n\t    };\n\t  });\n\t}\n\t\n\tfunction loadBookData(model) {\n\t  var path = '/obj/books/' + model;\n\t  var modelUrl = path + '/model.js';\n\t  var mapUrl = path + '/map.jpg';\n\t  var bumpMapUrl = path + '/bump_map.jpg';\n\t  var specularMapUrl = path + '/specular_map.jpg';\n\t\n\t  return Promise.all([loadGeometry(modelUrl), loadImage(mapUrl).catch(function () {\n\t    console.error('repository: Error loading book map:', model);\n\t    return null;\n\t  }), loadImage(bumpMapUrl).catch(function () {\n\t    console.error('repository: Error loading book bumpMap:', model);\n\t    return null;\n\t  }), loadImage(specularMapUrl).catch(function () {\n\t    console.error('repository: Error loading book specularMap:', model);\n\t    return null;\n\t  })]).then(function (results) {\n\t    return {\n\t      geometry: results[0],\n\t      mapImage: results[1],\n\t      bumpMapImage: results[2],\n\t      specularMapImage: results[3]\n\t    };\n\t  });\n\t}\n\t\n\tfunction loadGeometry(url) {\n\t  return new Promise(function (resolve, reject) {\n\t    jsonLoader.load(url, function (geometry) {\n\t      geometry.computeBoundingBox();\n\t      resolve(geometry);\n\t    }, function () {}, reject);\n\t  });\n\t}\n\t\n\tfunction loadImage(url) {\n\t  var img = new Image();\n\t\n\t  img.crossOrigin = '';\n\t  img.src = url;\n\t\n\t  return new Promise(function (resolve, reject) {\n\t    img.onload = function () {\n\t      resolve(img);\n\t    };\n\t\n\t    img.onerror = function (err) {\n\t      reject(err);\n\t    };\n\t  });\n\t}\n\t\n\tfunction loadData(url) {\n\t  return new Promise(function (resolve, reject) {\n\t    dataLoader.load(url, resolve, function () {}, reject);\n\t  });\n\t}\n\n/***/ },\n/* 7 */\n/*!****************************!*\\\n  !*** ./src/environment.js ***!\n  \\****************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _three = __webpack_require__(/*! three */ 2);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _BookMaterial = __webpack_require__(/*! ./materials/BookMaterial */ 8);\n\t\n\tvar _BookMaterial2 = _interopRequireDefault(_BookMaterial);\n\t\n\tvar _LibraryObject = __webpack_require__(/*! ./models/LibraryObject */ 11);\n\t\n\tvar _LibraryObject2 = _interopRequireDefault(_LibraryObject);\n\t\n\tvar _BookObject = __webpack_require__(/*! ./models/BookObject */ 12);\n\t\n\tvar _BookObject2 = _interopRequireDefault(_BookObject);\n\t\n\tvar _SectionObject = __webpack_require__(/*! ./models/SectionObject */ 13);\n\t\n\tvar _SectionObject2 = _interopRequireDefault(_SectionObject);\n\t\n\tvar _camera = __webpack_require__(/*! ./camera */ 15);\n\t\n\tvar _camera2 = _interopRequireDefault(_camera);\n\t\n\tvar _locator = __webpack_require__(/*! ./locator */ 1);\n\t\n\tvar _cache = __webpack_require__(/*! ./cache */ 5);\n\t\n\tvar cache = _interopRequireWildcard(_cache);\n\t\n\tvar _repository = __webpack_require__(/*! ./repository */ 6);\n\t\n\tvar repository = _interopRequireWildcard(_repository);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar environment = {};\n\t\n\tenvironment.CLEARANCE = 0.001;\n\t\n\tvar libraryDto = null;\n\tvar sections = {};\n\tvar books = {};\n\t\n\tenvironment.scene = null;\n\tenvironment.library = null;\n\t\n\tenvironment.loadLibrary = function (dto) {\n\t\tclearScene(); // inits some fields\n\t\n\t\tvar dict = parseLibraryDto(dto);\n\t\n\t\tsections = dict.sections;\n\t\tbooks = dict.books;\n\t\tlibraryDto = dto;\n\t\n\t\treturn initCache(libraryDto, dict.sections, dict.books).then(function () {\n\t\t\tcreateLibrary(libraryDto);\n\t\t\treturn createSections(sections);\n\t\t}).then(function () {\n\t\t\treturn _locator.locator.centerObject(_camera2.default.object);\n\t\t}).then(function () {\n\t\t\treturn createBooks(books);\n\t\t});\n\t};\n\t\n\tenvironment.getBook = function (bookId) {\n\t\treturn getDictObject(books, bookId);\n\t};\n\t\n\tenvironment.getSection = function (sectionId) {\n\t\treturn getDictObject(sections, sectionId);\n\t};\n\t\n\tenvironment.getShelf = function (sectionId, shelfId) {\n\t\tvar section = environment.getSection(sectionId);\n\t\tvar shelf = section && section.shelves[shelfId];\n\t\n\t\treturn shelf;\n\t};\n\t\n\tenvironment.updateSection = function (dto) {\n\t\tif (dto.libraryId == environment.library.getId()) {\n\t\t\tenvironment.removeSection(dto.id);\n\t\t\treturn createSection(dto);\n\t\t} else {\n\t\t\tenvironment.removeSection(dto.id);\n\t\t\treturn Promise.resolve(dto);\n\t\t}\n\t};\n\t\n\tenvironment.updateBook = function (dto) {\n\t\tif (getBookShelf(dto)) {\n\t\t\tenvironment.removeBook(dto.id);\n\t\t\treturn createBook(dto);\n\t\t} else {\n\t\t\tenvironment.removeBook(dto.id);\n\t\t\treturn Promise.resolve(true);\n\t\t}\n\t};\n\t\n\tenvironment.removeBook = function (id) {\n\t\tremoveObject(books, id);\n\t};\n\t\n\tenvironment.removeSection = function (id) {\n\t\tremoveObject(sections, id);\n\t};\n\t\n\tfunction removeObject(dict, key) {\n\t\tvar dictItem = dict[key];\n\t\tif (dictItem) {\n\t\t\tdelete dict[key];\n\t\n\t\t\tif (dictItem.obj) {\n\t\t\t\tdictItem.obj.setParent(null);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction initCache(libraryDto, sectionsDict, booksDict) {\n\t\tvar libraryModel = libraryDto.model;\n\t\tvar sectionModels = {};\n\t\tvar bookModels = {};\n\t\n\t\tfor (var sectionId in sectionsDict) {\n\t\t\tvar sectionDto = sectionsDict[sectionId].dto;\n\t\t\tsectionModels[sectionDto.model] = true;\n\t\t}\n\t\n\t\tfor (var bookId in booksDict) {\n\t\t\tvar bookDto = booksDict[bookId].dto;\n\t\t\tbookModels[bookDto.model] = true;\n\t\t}\n\t\n\t\treturn cache.init(libraryModel, sectionModels, bookModels);\n\t}\n\t\n\tfunction clearScene() {\n\t\tenvironment.library = null;\n\t\tsections = {};\n\t\tbooks = {};\n\t\n\t\twhile (environment.scene.children.length > 0) {\n\t\t\tif (environment.scene.children[0].dispose) {\n\t\t\t\tenvironment.scene.children[0].dispose();\n\t\t\t}\n\t\t\tenvironment.scene.remove(environment.scene.children[0]);\n\t\t}\n\t}\n\t\n\tfunction parseLibraryDto(libraryDto) {\n\t\tvar result = {\n\t\t\tsections: {},\n\t\t\tbooks: {}\n\t\t};\n\t\n\t\tfor (var sectionIndex = libraryDto.sections.length - 1; sectionIndex >= 0; sectionIndex--) {\n\t\t\tvar sectionDto = libraryDto.sections[sectionIndex];\n\t\t\tresult.sections[sectionDto.id] = { dto: sectionDto };\n\t\n\t\t\tfor (var bookIndex = sectionDto.books.length - 1; bookIndex >= 0; bookIndex--) {\n\t\t\t\tvar bookDto = sectionDto.books[bookIndex];\n\t\t\t\tresult.books[bookDto.id] = { dto: bookDto };\n\t\t\t}\n\t\n\t\t\tdelete sectionDto.books;\n\t\t}\n\t\n\t\tdelete libraryDto.sections;\n\t\n\t\treturn result;\n\t}\n\t\n\tfunction createLibrary(libraryDto) {\n\t\tvar library = null;\n\t\tvar libraryCache = cache.getLibrary();\n\t\tvar texture = new _three2.default.Texture(libraryCache.mapImage);\n\t\tvar material = new _three2.default.MeshPhongMaterial({ map: texture });\n\t\n\t\ttexture.needsUpdate = true;\n\t\tlibrary = new _LibraryObject2.default(libraryDto, libraryCache.geometry, material);\n\t\n\t\tlibrary.add(new _three2.default.AmbientLight(0x333333));\n\t\t_camera2.default.setParent(library);\n\t\n\t\tenvironment.scene.add(library);\n\t\tenvironment.library = library;\n\t}\n\t\n\tfunction createSections(sectionsDict) {\n\t\treturn createObjects(sectionsDict, createSection);\n\t}\n\t\n\tfunction createBooks(booksDict) {\n\t\treturn createObjects(booksDict, createBook);\n\t}\n\t\n\tfunction createObjects(dict, factory) {\n\t\tvar results = [];\n\t\tvar key;\n\t\n\t\tfor (key in dict) {\n\t\t\tresults.push(factory(dict[key].dto));\n\t\t}\n\t\n\t\treturn Promise.all(results);\n\t}\n\t\n\tfunction createSection(sectionDto) {\n\t\tvar promise = cache.getSection(sectionDto.model).then(function (sectionCache) {\n\t\t\tvar texture = new _three2.default.Texture(sectionCache.mapImage);\n\t\t\tvar material = new _three2.default.MeshPhongMaterial({ map: texture });\n\t\t\tvar section;\n\t\n\t\t\ttexture.needsUpdate = true;\n\t\t\tsectionDto.data = sectionCache.data;\n\t\n\t\t\tsection = new _SectionObject2.default(sectionDto, sectionCache.geometry, material);\n\t\n\t\t\tenvironment.library.add(section);\n\t\t\taddToDict(sections, section);\n\t\n\t\t\treturn sectionDto;\n\t\t});\n\t\n\t\treturn promise;\n\t}\n\t\n\tfunction createBook(bookDto) {\n\t\treturn Promise.all([cache.getBook(bookDto.model), bookDto.cover ? repository.loadImage(bookDto.cover.url) : Promise.resolve(null)]).then(function (results) {\n\t\t\tvar bookCache = results[0];\n\t\t\tvar coverMapImage = results[1];\n\t\t\tvar material = new _BookMaterial2.default(bookCache.mapImage, bookCache.bumpMapImage, bookCache.specularMapImage, coverMapImage);\n\t\t\tvar book = new _BookObject2.default(bookDto, bookCache.geometry, material);\n\t\n\t\t\taddToDict(books, book);\n\t\t\tplaceBookOnShelf(book);\n\t\t});\n\t}\n\t\n\tfunction addToDict(dict, obj) {\n\t\tvar dictItem = {\n\t\t\tdto: obj.dataObject,\n\t\t\tobj: obj\n\t\t};\n\t\n\t\tdict[obj.getId()] = dictItem;\n\t}\n\t\n\tfunction getDictObject(dict, objectId) {\n\t\tvar dictItem = dict[objectId];\n\t\tvar dictObject = dictItem && dictItem.obj;\n\t\n\t\treturn dictObject;\n\t}\n\t\n\tfunction getBookShelf(bookDto) {\n\t\treturn environment.getShelf(bookDto.sectionId, bookDto.shelfId);\n\t}\n\t\n\tfunction placeBookOnShelf(book) {\n\t\tvar shelf = getBookShelf(book.dataObject);\n\t\tshelf.add(book);\n\t}\n\t\n\texports.default = environment;\n\n/***/ },\n/* 8 */\n/*!***************************************!*\\\n  !*** ./src/materials/BookMaterial.js ***!\n  \\***************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _three = __webpack_require__(/*! three */ 2);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar vertexShader = __webpack_require__(/*! ./shaders/BookMaterial.vs */ 9);\n\tvar fragmentShader = __webpack_require__(/*! ./shaders/BookMaterial.fs */ 10);\n\t\n\tvar BookMaterial = (function (_THREE$ShaderMaterial) {\n\t\t_inherits(BookMaterial, _THREE$ShaderMaterial);\n\t\n\t\tfunction BookMaterial(mapImage, bumpMapImage, specularMapImage, coverMapImage) {\n\t\t\t_classCallCheck(this, BookMaterial);\n\t\n\t\t\tvar defines = {};\n\t\t\tvar uniforms;\n\t\t\tvar parameters;\n\t\n\t\t\tvar map;\n\t\t\tvar bumpMap;\n\t\t\tvar specularMap;\n\t\t\tvar coverMap;\n\t\n\t\t\tuniforms = _three2.default.UniformsUtils.merge([_three2.default.UniformsLib.common, _three2.default.UniformsLib.bump, _three2.default.UniformsLib.fog, _three2.default.UniformsLib.lights]);\n\t\n\t\t\tuniforms.shininess = { type: 'f', value: 30 };\n\t\t\tdefines.PHONG = true;\n\t\n\t\t\tif (mapImage) {\n\t\t\t\tmap = new _three2.default.Texture(mapImage);\n\t\t\t\tmap.needsUpdate = true;\n\t\t\t\tuniforms.map = { type: 't', value: map };\n\t\t\t}\n\t\n\t\t\tif (bumpMapImage) {\n\t\t\t\tbumpMap = new _three2.default.Texture(bumpMapImage);\n\t\t\t\tbumpMap.needsUpdate = true;\n\t\t\t\tuniforms.bumpMap = { type: 't', value: bumpMap };\n\t\t\t\tuniforms.bumpScale.value = 0.005;\n\t\t\t}\n\t\n\t\t\tif (specularMapImage) {\n\t\t\t\tspecularMap = new _three2.default.Texture(specularMapImage);\n\t\t\t\tspecularMap.needsUpdate = true;\n\t\t\t\tuniforms.specular = { type: 'c', value: new _three2.default.Color(0x555555) };\n\t\t\t\tuniforms.specularMap = { type: 't', value: specularMap };\n\t\t\t}\n\t\n\t\t\tif (coverMapImage) {\n\t\t\t\tcoverMap = new _three2.default.Texture(coverMapImage);\n\t\t\t\tcoverMap.needsUpdate = true;\n\t\t\t\tuniforms.coverMap = { type: 't', value: coverMap };\n\t\t\t\tdefines.USE_COVER = true;\n\t\t\t}\n\t\n\t\t\tparameters = {\n\t\t\t\tvertexShader: vertexShader,\n\t\t\t\tfragmentShader: fragmentShader,\n\t\t\t\tuniforms: uniforms,\n\t\t\t\tdefines: defines,\n\t\t\t\tlights: true,\n\t\t\t\tfog: true\n\t\t\t};\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(BookMaterial).call(this, parameters));\n\t\n\t\t\t_this.map = !!mapImage;\n\t\t\t_this.bumpMap = !!bumpMapImage;\n\t\t\t_this.specularMap = !!specularMapImage;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\treturn BookMaterial;\n\t})(_three2.default.ShaderMaterial);\n\t\n\texports.default = BookMaterial;\n\n/***/ },\n/* 9 */\n/*!***********************************************!*\\\n  !*** ./src/materials/shaders/BookMaterial.vs ***!\n  \\***********************************************/\n/***/ function(module, exports) {\n\n\tmodule.exports = \"varying vec3 vViewPosition;\\nvarying vec3 vNormal;\\n\\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\\n\\tvarying vec2 vUv;\\n\\tuniform vec4 offsetRepeat;\\n#endif\\n\\n#ifndef PHONG_PER_PIXEL\\n\\t#if MAX_POINT_LIGHTS > 0\\n\\t\\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\\t\\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\\t\\tvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\\n\\t#endif\\n\\n\\t#if MAX_SPOT_LIGHTS > 0\\n\\t\\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\\t\\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\\t\\tvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\\n\\t#endif\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\\n\\tvarying vec3 vWorldPosition;\\n#endif\\n\\n#ifdef USE_COLOR\\n\\tvarying vec3 vColor;\\n#endif\\n\\nvoid main() {\\n\\t#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\\n\\t\\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\\n\\t#endif\\n\\n\\t#ifdef USE_COLOR\\n\\t\\t#ifdef GAMMA_INPUT\\n\\t\\t\\tvColor = color * color;\\n\\t\\t#else\\n\\t\\t\\tvColor = color;\\n\\t\\t#endif\\n\\t#endif\\n\\n\\tvec3 objectNormal;\\n\\t#ifdef USE_SKINNING\\n\\t\\tobjectNormal = skinnedNormal.xyz;\\n\\t#endif\\n\\n\\t#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\\n\\t\\tobjectNormal = morphedNormal;\\n\\t#endif\\n\\n\\t#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\\n\\t\\tobjectNormal = normal;\\n\\t#endif\\n\\n\\t#ifdef FLIP_SIDED\\n\\t\\tobjectNormal = -objectNormal;\\n\\t#endif\\n\\n\\tvec3 transformedNormal = normalMatrix * objectNormal;\\n\\tvNormal = normalize(transformedNormal);\\n\\tvec4 mvPosition;\\n\\t#ifdef USE_SKINNING\\n\\t\\tmvPosition = modelViewMatrix * skinned;\\n\\t#endif\\n\\n\\t#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\\n\\t\\tmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\\n\\t#endif\\n\\n\\t#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\\n\\t\\tmvPosition = modelViewMatrix * vec4( position, 1.0 );\\n\\t#endif\\n\\n\\tgl_Position = projectionMatrix * mvPosition;\\n\\tvViewPosition = -mvPosition.xyz;\\n\\t#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\\n\\t\\t#ifdef USE_SKINNING\\n\\t\\t\\tvec4 worldPosition = modelMatrix * skinned;\\n\\t\\t#endif\\n\\n\\t\\t#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\\n\\t\\t\\tvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\\n\\t\\t#endif\\n\\n\\t\\t#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\\n\\t\\t\\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\\n\\t\\t#endif\\n\\t#endif\\n\\n\\t#ifndef PHONG_PER_PIXEL\\n\\t\\t#if MAX_POINT_LIGHTS > 0\\n\\t\\t\\tfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\t\\t\\t\\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\\n\\t\\t\\t\\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\\n\\t\\t\\t\\tfloat lDistance = 1.0;\\n\\n\\t\\t\\t\\tif ( pointLightDistance[ i ] > 0.0 )\\n\\t\\t\\t\\t\\tlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\\n\\t\\t\\t\\t\\tvPointLight[ i ] = vec4( lVector, lDistance );\\n\\t\\t\\t}\\n\\t\\t#endif\\n\\n\\t\\t#if MAX_SPOT_LIGHTS > 0\\n\\t\\t\\tfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\t\\t\\t\\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\\n\\t\\t\\t\\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\\n\\t\\t\\t\\tfloat lDistance = 1.0;\\n\\n\\t\\t\\t\\tif ( spotLightDistance[ i ] > 0.0 )\\n\\t\\t\\t\\t\\tlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\\n\\t\\t\\t\\t\\tvSpotLight[ i ] = vec4( lVector, lDistance );\\n\\t\\t\\t}\\n\\t\\t#endif\\n\\t#endif\\n\\n\\t#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\\n\\t\\tvWorldPosition = worldPosition.xyz;\\n\\t#endif\\n}\"\n\n/***/ },\n/* 10 */\n/*!***********************************************!*\\\n  !*** ./src/materials/shaders/BookMaterial.fs ***!\n  \\***********************************************/\n/***/ function(module, exports) {\n\n\tmodule.exports = \"uniform vec3 diffuse;\\nuniform float opacity;\\nuniform vec3 emissive;\\nuniform vec3 specular;\\nuniform float shininess;\\nuniform sampler2D coverMap;\\n\\n#ifdef USE_COLOR\\n\\tvarying vec3 vColor;\\n#endif\\n\\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\\n\\tvarying vec2 vUv;\\n#endif\\n\\n#ifdef USE_MAP\\n\\tuniform sampler2D map;\\n#endif\\n\\n#ifdef USE_FOG\\n\\tuniform vec3 fogColor;\\n\\n\\t#ifdef FOG_EXP2\\n\\t\\tuniform float fogDensity;\\n\\t#else\\n\\t\\tuniform float fogNear;\\n\\t\\tuniform float fogFar;\\n\\t#endif\\n#endif\\n\\nuniform vec3 ambientLightColor;\\n#if MAX_DIR_LIGHTS > 0\\n\\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\\t#ifdef PHONG_PER_PIXEL\\n\\t\\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\\t\\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\\t#else\\n\\t\\tvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\\n\\t#endif\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\\t#ifdef PHONG_PER_PIXEL\\n\\t\\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\\t#else\\n\\t\\tvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\\n\\t#endif\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\\n\\tvarying vec3 vWorldPosition;\\n#endif\\n\\n#ifdef WRAP_AROUND\\n\\tuniform vec3 wrapRGB;\\n#endif\\n\\nvarying vec3 vViewPosition;\\nvarying vec3 vNormal;\\n#ifdef USE_BUMPMAP\\n\\tuniform sampler2D bumpMap;\\n\\tuniform float bumpScale;\\n\\tvec2 dHdxy_fwd() {\\n\\t\\tvec2 dSTdx = dFdx( vUv );\\n\\t\\tvec2 dSTdy = dFdy( vUv );\\n\\t\\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\\t\\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\\t\\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\t\\treturn vec2( dBx, dBy );\\n\\t}\\n\\n\\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\t\\tvec3 vSigmaX = dFdx( surf_pos );\\n\\t\\tvec3 vSigmaY = dFdy( surf_pos );\\n\\t\\tvec3 vN = surf_norm;\\n\\t\\tvec3 R1 = cross( vSigmaY, vN );\\n\\t\\tvec3 R2 = cross( vN, vSigmaX );\\n\\t\\tfloat fDet = dot( vSigmaX, R1 );\\n\\t\\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\\t\\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\t}\\n#endif\\n\\n#ifdef USE_SPECULARMAP\\n\\tuniform sampler2D specularMap;\\n#endif\\n\\nvoid main() {\\n\\tvec4 testcolor = vec4(1.0, 1.0, 1.0, 1.0);\\n\\tfloat eps = 0.004;\\n\\tvec4 baseColor  = texture2D(map, vUv);\\n\\t#ifdef USE_COVER\\n\\t\\tvec4 coverColor = texture2D(coverMap, vUv * vec2(2.3, 1.3) - vec2(1.3, 0.3));\\n\\t\\tif(vUv.y > 0.23 && (vUv.x > 0.57 || (all(greaterThanEqual(baseColor,testcolor-eps)) && all(lessThanEqual(baseColor,testcolor+eps)))))\\n\\t\\t\\tgl_FragColor = coverColor;\\n\\t\\telse\\n\\t\\t\\tgl_FragColor = baseColor;\\n\\t#else\\n\\t\\tgl_FragColor = baseColor;\\n\\t#endif\\n\\n\\tfloat specularStrength;\\n\\t#ifdef USE_SPECULARMAP\\n\\t\\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\\t\\tspecularStrength = texelSpecular.r;\\n\\t#else\\n\\t\\tspecularStrength = 1.0;\\n\\t#endif\\n\\n\\tvec3 normal = normalize( vNormal );\\n\\tvec3 viewPosition = normalize( vViewPosition );\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\\t#endif\\n\\n\\t#ifdef USE_NORMALMAP\\n\\t\\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n\\t#elif defined( USE_BUMPMAP )\\n\\t\\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n\\t#endif\\n\\n\\t#if MAX_POINT_LIGHTS > 0\\n\\t\\tvec3 pointDiffuse  = vec3( 0.0 );\\n\\t\\tvec3 pointSpecular = vec3( 0.0 );\\n\\n\\t\\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\t\\t\\t#ifdef PHONG_PER_PIXEL\\n\\t\\t\\t\\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\\n\\t\\t\\t\\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\\n\\t\\t\\t\\tfloat lDistance = 1.0;\\n\\t\\t\\t\\n\\t\\t\\t\\tif ( pointLightDistance[ i ] > 0.0 )\\n\\t\\t\\t\\t\\tlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\\n\\t\\t\\t\\tlVector = normalize( lVector );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec3 lVector = normalize( vPointLight[ i ].xyz );\\n\\t\\t\\t\\tfloat lDistance = vPointLight[ i ].w;\\n\\t\\t\\t#endif\\n\\n\\t\\t\\tfloat dotProduct = dot( normal, lVector );\\n\\t\\t\\t#ifdef WRAP_AROUND\\n\\t\\t\\t\\tfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\\n\\t\\t\\t\\tfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\t\\t\\t\\tvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tfloat pointDiffuseWeight = max( dotProduct, 0.0 );\\n\\t\\t\\t#endif\\n\\n\\t\\t\\tpointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\\n\\t\\t\\tvec3 pointHalfVector = normalize( lVector + viewPosition );\\n\\t\\t\\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\\n\\t\\t\\tfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\\n\\n\\t\\t\\t#ifdef PHYSICALLY_BASED_SHADING\\n\\t\\t\\t\\tfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\\n\\t\\t\\t\\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\\n\\t\\t\\t\\tpointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\\n\\t\\t\\t#else\\n\\t\\t\\t\\tpointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\\n\\t\\t\\t#endif\\n\\t\\t}\\n\\t#endif\\n\\n\\t#if MAX_SPOT_LIGHTS > 0\\n\\t\\tvec3 spotDiffuse  = vec3( 0.0 );\\n\\t\\tvec3 spotSpecular = vec3( 0.0 );\\n\\t\\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\t\\t\\t#ifdef PHONG_PER_PIXEL\\n\\t\\t\\t\\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\\n\\t\\t\\t\\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\\n\\t\\t\\t\\tfloat lDistance = 1.0;\\n\\n\\t\\t\\t\\tif ( spotLightDistance[ i ] > 0.0 )\\n\\t\\t\\t\\t\\tlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );-\\n\\n\\t\\t\\t\\tlVector = normalize( lVector );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec3 lVector = normalize( vSpotLight[ i ].xyz );\\n\\t\\t\\t\\tfloat lDistance = vSpotLight[ i ].w;\\n\\t\\t\\t#endif\\n\\n\\t\\t\\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\\n\\t\\t\\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\t\\t\\t\\tspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\\n\\t\\t\\t\\tfloat dotProduct = dot( normal, lVector );\\n\\n\\t\\t\\t\\t#ifdef WRAP_AROUND\\n\\t\\t\\t\\t\\tfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\\n\\t\\t\\t\\t\\tfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\t\\t\\t\\t\\tvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\\n\\t\\t\\t\\t#else\\n\\t\\t\\t\\t\\tfloat spotDiffuseWeight = max( dotProduct, 0.0 );\\n\\t\\t\\t\\t#endif\\n\\n\\t\\t\\t\\tspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\\n\\t\\t\\t\\tvec3 spotHalfVector = normalize( lVector + viewPosition );\\n\\t\\t\\t\\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\\n\\t\\t\\t\\tfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t#ifdef PHYSICALLY_BASED_SHADING\\n\\t\\t\\t\\t\\tfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\\n\\t\\t\\t\\t\\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\\n\\t\\t\\t\\t\\tspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\\n\\t\\t\\t\\t#else\\n\\t\\t\\t\\t\\tspotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\\n\\t\\t\\t\\t#endif\\n\\t\\t\\t}\\n\\t\\t}\\n\\t#endif\\n\\n\\t#if MAX_DIR_LIGHTS > 0\\n\\t\\tvec3 dirDiffuse  = vec3( 0.0 );\\n\\t\\tvec3 dirSpecular = vec3( 0.0 );\\n\\t\\t\\n\\t\\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\t\\t\\tvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\\n\\t\\t\\tvec3 dirVector = normalize( lDirection.xyz );\\n\\t\\t\\tfloat dotProduct = dot( normal, dirVector );\\n\\t\\t\\t\\n\\t\\t\\t#ifdef WRAP_AROUND\\n\\t\\t\\t\\tfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\\n\\t\\t\\t\\tfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\t\\t\\t\\tvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tfloat dirDiffuseWeight = max( dotProduct, 0.0 );\\n\\t\\t\\t#endif\\n\\n\\t\\t\\tdirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\\n\\t\\t\\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\\n\\t\\t\\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\\n\\t\\t\\tfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\\n\\t\\t\\t\\n\\t\\t\\t#ifdef PHYSICALLY_BASED_SHADING\\n\\t\\t\\t\\tfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\\n\\t\\t\\t\\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\\n\\t\\t\\t\\tdirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\\n\\t\\t\\t#else\\n\\t\\t\\t\\tdirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\\n\\t\\t\\t#endif\\n\\t\\t}\\n\\t#endif\\n\\n\\t#if MAX_HEMI_LIGHTS > 0\\n\\t\\tvec3 hemiDiffuse  = vec3( 0.0 );\\n\\t\\tvec3 hemiSpecular = vec3( 0.0 );\\n\\t\\t\\n\\t\\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\t\\t\\tvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\\n\\t\\t\\tvec3 lVector = normalize( lDirection.xyz );\\n\\t\\t\\tfloat dotProduct = dot( normal, lVector );\\n\\t\\t\\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\t\\t\\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\t\\t\\themiDiffuse += diffuse * hemiColor;\\n\\t\\t\\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\\n\\t\\t\\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\\n\\t\\t\\tfloat hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\\n\\t\\t\\tvec3 lVectorGround = -lVector;\\n\\t\\t\\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\\n\\t\\t\\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\\n\\t\\t\\tfloat hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\\n\\t\\t\\t\\n\\t\\t\\t#ifdef PHYSICALLY_BASED_SHADING\\n\\t\\t\\t\\tfloat dotProductGround = dot( normal, lVectorGround );\\n\\t\\t\\t\\tfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\\n\\t\\t\\t\\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\\n\\t\\t\\t\\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\\n\\t\\t\\t\\themiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\\n\\t\\t\\t#else\\n\\t\\t\\t\\themiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\\n\\t\\t\\t#endif\\n\\t\\t}\\n\\t#endif\\n\\n\\tvec3 totalDiffuse = vec3( 0.0 );\\n\\tvec3 totalSpecular = vec3( 0.0 );\\n\\t#if MAX_DIR_LIGHTS > 0\\n\\t\\ttotalDiffuse += dirDiffuse;\\n\\t\\ttotalSpecular += dirSpecular;\\n\\t#endif\\n\\n\\t#if MAX_HEMI_LIGHTS > 0\\n\\t\\ttotalDiffuse += hemiDiffuse;\\n\\t\\ttotalSpecular += hemiSpecular;\\n\\t#endif\\n\\n\\t#if MAX_POINT_LIGHTS > 0\\n\\t\\ttotalDiffuse += pointDiffuse;\\n\\t\\ttotalSpecular += pointSpecular;\\n\\t#endif\\n\\n\\t#if MAX_SPOT_LIGHTS > 0\\n\\t\\ttotalDiffuse += spotDiffuse;\\n\\t\\ttotalSpecular += spotSpecular;\\n\\t#endif\\n\\n\\t#ifdef METAL\\n\\t\\tgl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor + totalSpecular );\\n\\t#else\\n\\t\\tgl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor ) + totalSpecular;\\n\\t#endif\\n\\n\\t#ifdef USE_COLOR\\n\\t\\tgl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\\n\\t#endif\\n\\n\\t#ifdef USE_FOG\\n\\t\\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\\n\\t\\t\\n\\t\\t#ifdef FOG_EXP2\\n\\t\\t\\tconst float LOG2 = 1.442695;\\n\\t\\t\\tfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\\n\\t\\t\\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\\n\\t\\t#else\\n\\t\\t\\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\\n\\t\\t#endif\\n\\n\\t\\tgl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\\n\\t#endif\\n}\"\n\n/***/ },\n/* 11 */\n/*!*************************************!*\\\n  !*** ./src/models/LibraryObject.js ***!\n  \\*************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _BaseObject2 = __webpack_require__(/*! ./BaseObject */ 4);\n\t\n\tvar _BaseObject3 = _interopRequireDefault(_BaseObject2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar LibraryObject = (function (_BaseObject) {\n\t\t_inherits(LibraryObject, _BaseObject);\n\t\n\t\tfunction LibraryObject(params, geometry, material) {\n\t\t\t_classCallCheck(this, LibraryObject);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(LibraryObject).call(this, params, geometry, material));\n\t\t}\n\t\n\t\treturn LibraryObject;\n\t})(_BaseObject3.default);\n\t\n\texports.default = LibraryObject;\n\n/***/ },\n/* 12 */\n/*!**********************************!*\\\n  !*** ./src/models/BookObject.js ***!\n  \\**********************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _BaseObject2 = __webpack_require__(/*! ./BaseObject */ 4);\n\t\n\tvar _BaseObject3 = _interopRequireDefault(_BaseObject2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar TYPE = 'BookObject';\n\t\n\tvar BookObject = (function (_BaseObject) {\n\t\t_inherits(BookObject, _BaseObject);\n\t\n\t\tfunction BookObject(dataObject, geometry, material) {\n\t\t\t_classCallCheck(this, BookObject);\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(BookObject).call(this, dataObject, geometry, material));\n\t\t}\n\t\n\t\t_createClass(BookObject, [{\n\t\t\tkey: 'getDto',\n\t\t\tvalue: function getDto() {\n\t\t\t\treturn {\n\t\t\t\t\tid: this.getId(),\n\t\t\t\t\tuserId: this.dataObject.userId,\n\t\t\t\t\tpos_x: this.position.x,\n\t\t\t\t\tpos_y: this.position.y,\n\t\t\t\t\tpos_z: this.position.z\n\t\t\t\t};\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'setParent',\n\t\t\tvalue: function setParent(parent) {\n\t\t\t\tif (this.parent != parent) {\n\t\t\t\t\tif (parent) {\n\t\t\t\t\t\tparent.add(this);\n\t\t\t\t\t\tthis.dataObject.shelfId = parent.getId();\n\t\t\t\t\t\tthis.dataObject.sectionId = parent.parent.getId();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.parent.remove(this);\n\t\t\t\t\t\tthis.dataObject.shelfId = null;\n\t\t\t\t\t\tthis.dataObject.sectionId = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'vbType',\n\t\t\tget: function get() {\n\t\t\t\treturn TYPE;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: 'TYPE',\n\t\t\tget: function get() {\n\t\t\t\treturn TYPE;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn BookObject;\n\t})(_BaseObject3.default);\n\t\n\texports.default = BookObject;\n\n/***/ },\n/* 13 */\n/*!*************************************!*\\\n  !*** ./src/models/SectionObject.js ***!\n  \\*************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _BaseObject2 = __webpack_require__(/*! ./BaseObject */ 4);\n\t\n\tvar _BaseObject3 = _interopRequireDefault(_BaseObject2);\n\t\n\tvar _ShelfObject = __webpack_require__(/*! ./ShelfObject */ 14);\n\t\n\tvar _ShelfObject2 = _interopRequireDefault(_ShelfObject);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar TYPE = 'SectionObject';\n\t\n\tvar SectionObject = (function (_BaseObject) {\n\t\t_inherits(SectionObject, _BaseObject);\n\t\n\t\tfunction SectionObject(params, geometry, material) {\n\t\t\t_classCallCheck(this, SectionObject);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(SectionObject).call(this, params, geometry, material));\n\t\n\t\t\t_this.shelves = {};\n\t\t\tfor (var key in params.data.shelves) {\n\t\t\t\t_this.shelves[key] = new _ShelfObject2.default(params.data.shelves[key]);\n\t\t\t\t_this.add(_this.shelves[key]);\n\t\t\t}\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(SectionObject, [{\n\t\t\tkey: 'getDto',\n\t\t\tvalue: function getDto() {\n\t\t\t\treturn {\n\t\t\t\t\tid: this.getId(),\n\t\t\t\t\tuserId: this.dataObject.userId,\n\t\t\t\t\tpos_x: this.position.x,\n\t\t\t\t\tpos_y: this.position.y,\n\t\t\t\t\tpos_z: this.position.z,\n\t\t\t\t\trotation: [this.rotation.x, this.rotation.y, this.rotation.z]\n\t\t\t\t};\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'setParent',\n\t\t\tvalue: function setParent(parent) {\n\t\t\t\tif (this.parent != parent) {\n\t\t\t\t\tif (parent) {\n\t\t\t\t\t\tparent.add(this);\n\t\t\t\t\t\tthis.dataObject.libraryId = parent.getId();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.parent.remove(this);\n\t\t\t\t\t\tthis.dataObject.libraryId = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'vbType',\n\t\t\tget: function get() {\n\t\t\t\treturn TYPE;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: 'TYPE',\n\t\t\tget: function get() {\n\t\t\t\treturn TYPE;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn SectionObject;\n\t})(_BaseObject3.default);\n\t\n\texports.default = SectionObject;\n\n/***/ },\n/* 14 */\n/*!***********************************!*\\\n  !*** ./src/models/ShelfObject.js ***!\n  \\***********************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _three = __webpack_require__(/*! three */ 2);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _BaseObject2 = __webpack_require__(/*! ./BaseObject */ 4);\n\t\n\tvar _BaseObject3 = _interopRequireDefault(_BaseObject2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar TYPE = 'ShelfObject';\n\t\n\tvar ShelfObject = (function (_BaseObject) {\n\t\t_inherits(ShelfObject, _BaseObject);\n\t\n\t\tfunction ShelfObject(params) {\n\t\t\t_classCallCheck(this, ShelfObject);\n\t\n\t\t\tvar size = params.size;\n\t\t\tvar geometry = new _three2.default.BoxGeometry(size[0], size[1], size[2]);\n\t\n\t\t\tgeometry.computeBoundingBox();\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(ShelfObject).call(this, params, geometry));\n\t\n\t\t\t_this.position.set(params.position[0], params.position[1], params.position[2]);\n\t\t\t_this.size = new _three2.default.Vector3(size[0], size[1], size[2]);\n\t\n\t\t\t_this.material.transparent = true;\n\t\t\t_this.material.opacity = 0;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\t_createClass(ShelfObject, [{\n\t\t\tkey: 'vbType',\n\t\t\tget: function get() {\n\t\t\t\treturn TYPE;\n\t\t\t}\n\t\t}], [{\n\t\t\tkey: 'TYPE',\n\t\t\tget: function get() {\n\t\t\t\treturn TYPE;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn ShelfObject;\n\t})(_BaseObject3.default);\n\t\n\texports.default = ShelfObject;\n\n/***/ },\n/* 15 */\n/*!***********************!*\\\n  !*** ./src/camera.js ***!\n  \\***********************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _three = __webpack_require__(/*! three */ 2);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _CameraObject = __webpack_require__(/*! ./models/CameraObject */ 16);\n\t\n\tvar _CameraObject2 = _interopRequireDefault(_CameraObject);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar camera = {\n\t\tHEIGTH: 1.5,\n\t\tobject: new _CameraObject2.default(),\n\t\tsetParent: function setParent(parent) {\n\t\t\tparent.add(this.object);\n\t\t},\n\t\tgetPosition: function getPosition() {\n\t\t\treturn this.object.position;\n\t\t}\n\t};\n\t\n\tvar init = function init(width, height) {\n\t\tcamera.camera = new _three2.default.PerspectiveCamera(45, width / height, 0.01, 50);\n\t\tcamera.object.position.set(0, camera.HEIGTH, 0);\n\t\tcamera.object.rotation.order = 'YXZ';\n\t\n\t\tvar candle = new _three2.default.PointLight(0x665555, 1.6, 10);\n\t\tcandle.position.set(0, 0, 0);\n\t\n\t\tcamera.object.add(candle);\n\t\tcamera.object.add(camera.camera);\n\t};\n\t\n\tcamera.rotate = function (x, y) {\n\t\tvar newX = this.object.rotation.x + y * 0.0001 || 0;\n\t\tvar newY = this.object.rotation.y + x * 0.0001 || 0;\n\t\n\t\tif (newX < 1.57 && newX > -1.57) {\n\t\t\tthis.object.rotation.x = newX;\n\t\t}\n\t\n\t\tthis.object.rotation.y = newY;\n\t};\n\t\n\tcamera.go = function (speed) {\n\t\tvar direction = this.getVector();\n\t\tvar newPosition = this.object.position.clone();\n\t\tnewPosition.add(direction.multiplyScalar(speed));\n\t\n\t\tthis.object.move(newPosition);\n\t};\n\t\n\tcamera.getVector = function () {\n\t\tvar vector = new _three2.default.Vector3(0, 0, -1);\n\t\n\t\treturn vector.applyEuler(this.object.rotation);\n\t};\n\t\n\tinit(1024, 768);\n\t\n\texports.default = camera;\n\n/***/ },\n/* 16 */\n/*!************************************!*\\\n  !*** ./src/models/CameraObject.js ***!\n  \\************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _three = __webpack_require__(/*! three */ 2);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _BaseObject2 = __webpack_require__(/*! ./BaseObject */ 4);\n\t\n\tvar _BaseObject3 = _interopRequireDefault(_BaseObject2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar CameraObject = (function (_BaseObject) {\n\t\t_inherits(CameraObject, _BaseObject);\n\t\n\t\tfunction CameraObject() {\n\t\t\t_classCallCheck(this, CameraObject);\n\t\n\t\t\tvar geometry = new _three2.default.Geometry();\n\t\t\tgeometry.boundingBox = new _three2.default.Box3(new _three2.default.Vector3(-0.1, -1, -0.1), new _three2.default.Vector3(0.1, 1, 0.1));\n\t\n\t\t\treturn _possibleConstructorReturn(this, Object.getPrototypeOf(CameraObject).call(this, null, geometry));\n\t\t}\n\t\n\t\t_createClass(CameraObject, [{\n\t\t\tkey: 'updateBoundingBox',\n\t\t\tvalue: function updateBoundingBox() {\n\t\t\t\tvar radius = {\n\t\t\t\t\tx: this.geometry.boundingBox.max.x,\n\t\t\t\t\ty: this.geometry.boundingBox.max.y,\n\t\t\t\t\tz: this.geometry.boundingBox.max.z\n\t\t\t\t};\n\t\n\t\t\t\tthis.boundingBox = {\n\t\t\t\t\tradius: radius,\n\t\t\t\t\tcenter: this.position //TODO: needs center of section in parent or world coordinates\n\t\t\t\t};\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn CameraObject;\n\t})(_BaseObject3.default);\n\t\n\texports.default = CameraObject;\n\n/***/ },\n/* 17 */\n/*!**********************!*\\\n  !*** ./src/mouse.js ***!\n  \\**********************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.mouse = undefined;\n\t\n\tvar _three = __webpack_require__(/*! three */ 2);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _camera = __webpack_require__(/*! ./camera */ 15);\n\t\n\tvar _camera2 = _interopRequireDefault(_camera);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar mouse = exports.mouse = {};\n\t\n\tfunction getWidth() {\n\t\treturn window.innerWidth;\n\t}\n\t\n\tfunction getHeight() {\n\t\treturn window.innerHeight;\n\t}\n\t\n\tvar x = null;\n\tvar y = null;\n\t\n\tmouse.target = null;\n\tmouse.dX = null;\n\tmouse.dY = null;\n\tmouse.longX = null;\n\tmouse.longY = null;\n\t\n\tmouse.getTarget = function () {\n\t\treturn this.target;\n\t};\n\t\n\tmouse.down = function (event) {\n\t\tif (event) {\n\t\t\tthis[event.which] = true;\n\t\t\tthis.target = event.target;\n\t\t\tx = event.clientX;\n\t\t\ty = event.clientY;\n\t\t\tmouse.longX = getWidth() * 0.5 - x;\n\t\t\tmouse.longY = getHeight() * 0.5 - y;\n\t\t}\n\t};\n\t\n\tmouse.up = function (event) {\n\t\tif (event) {\n\t\t\tthis[event.which] = false;\n\t\t\t// linux chrome bug fix (when both keys release then both event.which equal 3)\n\t\t\tthis[1] = false;\n\t\t}\n\t};\n\t\n\tmouse.move = function (event) {\n\t\tif (event) {\n\t\t\tthis.target = event.target;\n\t\t\tmouse.longX = getWidth() * 0.5 - x;\n\t\t\tmouse.longY = getHeight() * 0.5 - y;\n\t\t\tmouse.dX = event.clientX - x;\n\t\t\tmouse.dY = event.clientY - y;\n\t\t\tx = event.clientX;\n\t\t\ty = event.clientY;\n\t\t}\n\t};\n\t\n\tmouse.getIntersected = function (objects, recursive, searchFor) {\n\t\tvar vector, raycaster, intersects, intersected, result, i, j;\n\t\n\t\tresult = null;\n\t\tvector = getVector();\n\t\traycaster = new _three2.default.Raycaster();\n\t\traycaster.set(_camera2.default.getPosition(), vector);\n\t\tintersects = raycaster.intersectObjects(objects, recursive);\n\t\n\t\tif (searchFor) {\n\t\t\tif (intersects.length) {\n\t\t\t\tfor (i = 0; i < intersects.length; i++) {\n\t\t\t\t\tintersected = intersects[i];\n\t\n\t\t\t\t\tfor (j = searchFor.length - 1; j >= 0; j--) {\n\t\t\t\t\t\tif (intersected.object instanceof searchFor[j]) {\n\t\t\t\t\t\t\tresult = intersected;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (result) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tresult = intersects;\n\t\t}\n\t\n\t\treturn result;\n\t};\n\t\n\tfunction getVector() {\n\t\tvar vector = new _three2.default.Vector3(x / getWidth() * 2 - 1, -(y / getHeight()) * 2 + 1, 0.5);\n\t\tvector.unproject(_camera2.default.camera);\n\t\n\t\treturn vector.sub(_camera2.default.getPosition()).normalize();\n\t}\n\n/***/ },\n/* 18 */\n/*!************************!*\\\n  !*** ./src/preview.js ***!\n  \\************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.preview = undefined;\n\t\n\tvar _three = __webpack_require__(/*! three */ 2);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _camera = __webpack_require__(/*! ./camera */ 15);\n\t\n\tvar _camera2 = _interopRequireDefault(_camera);\n\t\n\tvar _highlight = __webpack_require__(/*! ./highlight */ 19);\n\t\n\tvar _highlight2 = _interopRequireDefault(_highlight);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar preview = exports.preview = {};\n\t\n\tvar active = false;\n\tvar container;\n\t\n\tfunction init() {\n\t\tcontainer = new _three2.default.Object3D();\n\t\tcontainer.position.set(0, 0, -0.5);\n\t\tcontainer.rotation.y = -2;\n\t\t_camera2.default.camera.add(container);\n\t}\n\t\n\tfunction activate(value) {\n\t\tactive = value;\n\t\t_highlight2.default.enable(!active);\n\t}\n\t\n\tpreview.isActive = function () {\n\t\treturn active;\n\t};\n\t\n\tpreview.enable = function (obj) {\n\t\tvar objClone;\n\t\n\t\tif (obj) {\n\t\t\tactivate(true);\n\t\n\t\t\tobjClone = obj.clone();\n\t\t\tobjClone.position.set(0, 0, 0);\n\t\t\tcontainer.add(objClone);\n\t\t}\n\t};\n\t\n\tpreview.disable = function () {\n\t\tclearContainer();\n\t\tactivate(false);\n\t};\n\t\n\tfunction clearContainer() {\n\t\tcontainer.children.forEach(function (child) {\n\t\t\tcontainer.remove(child);\n\t\t});\n\t}\n\t\n\tpreview.rotate = function (dX) {\n\t\tcontainer.rotation.y += dX ? dX * 0.05 : 0;\n\t};\n\t\n\tinit();\n\n/***/ },\n/* 19 */\n/*!**************************!*\\\n  !*** ./src/highlight.js ***!\n  \\**************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _three = __webpack_require__(/*! three */ 2);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _environment = __webpack_require__(/*! ./environment */ 7);\n\t\n\tvar _environment2 = _interopRequireDefault(_environment);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar highlight = {};\n\t\n\tvar PLANE_ROTATION = Math.PI * 0.5;\n\tvar PLANE_MULTIPLIER = 2;\n\tvar COLOR_SELECT = 0x005533;\n\tvar COLOR_FOCUS = 0x003355;\n\t\n\tvar selectPlane;\n\tvar focusPlane;\n\t\n\tvar init = function init() {\n\t\tvar materialProperties = {\n\t\t\tmap: new _three2.default.ImageUtils.loadTexture(__webpack_require__(/*! ./img/glow.png */ 20)),\n\t\t\ttransparent: true,\n\t\t\tside: _three2.default.DoubleSide,\n\t\t\tblending: _three2.default.AdditiveBlending,\n\t\t\tdepthTest: false\n\t\t};\n\t\n\t\tmaterialProperties.color = COLOR_SELECT;\n\t\tvar materialSelect = new _three2.default.MeshBasicMaterial(materialProperties);\n\t\n\t\tmaterialProperties.color = COLOR_FOCUS;\n\t\tvar materialFocus = new _three2.default.MeshBasicMaterial(materialProperties);\n\t\n\t\tvar geometry = new _three2.default.PlaneBufferGeometry(1, 1, 1);\n\t\n\t\tselectPlane = new _three2.default.Mesh(geometry, materialSelect);\n\t\tselectPlane.rotation.x = PLANE_ROTATION;\n\t\n\t\tfocusPlane = new _three2.default.Mesh(geometry, materialFocus);\n\t\tfocusPlane.rotation.x = PLANE_ROTATION;\n\t};\n\t\n\tvar commonHighlight = function commonHighlight(which, obj) {\n\t\tif (obj) {\n\t\t\tvar width = obj.geometry.boundingBox.max.x * PLANE_MULTIPLIER;\n\t\t\tvar height = obj.geometry.boundingBox.max.z * PLANE_MULTIPLIER;\n\t\t\tvar bottom = obj.geometry.boundingBox.min.y + _environment2.default.CLEARANCE;\n\t\n\t\t\twhich.position.y = bottom;\n\t\t\twhich.scale.set(width, height, 1);\n\t\t\tobj.add(which);\n\t\n\t\t\twhich.visible = true;\n\t\t} else {\n\t\t\twhich.visible = false;\n\t\t}\n\t};\n\t\n\thighlight.enable = function (enable) {\n\t\tfocusPlane.visible = selectPlane.visible = enable;\n\t};\n\t\n\thighlight.focus = function (obj) {\n\t\tcommonHighlight(focusPlane, obj);\n\t};\n\t\n\thighlight.select = function (obj) {\n\t\tcommonHighlight(selectPlane, obj);\n\t};\n\t\n\tinit();\n\t\n\texports.default = highlight;\n\n/***/ },\n/* 20 */\n/*!**************************!*\\\n  !*** ./src/img/glow.png ***!\n  \\**************************/\n/***/ function(module, exports) {\n\n\tmodule.exports = \"data:image/png;base64,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\"\n\n/***/ },\n/* 21 */\n/*!*************************!*\\\n  !*** ./src/selector.js ***!\n  \\*************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.selector = undefined;\n\t\n\tvar _SelectorMeta = __webpack_require__(/*! ./models/SelectorMeta */ 22);\n\t\n\tvar _SelectorMeta2 = _interopRequireDefault(_SelectorMeta);\n\t\n\tvar _ShelfObject = __webpack_require__(/*! ./models/ShelfObject */ 14);\n\t\n\tvar _ShelfObject2 = _interopRequireDefault(_ShelfObject);\n\t\n\tvar _BookObject = __webpack_require__(/*! ./models/BookObject */ 12);\n\t\n\tvar _BookObject2 = _interopRequireDefault(_BookObject);\n\t\n\tvar _SectionObject = __webpack_require__(/*! ./models/SectionObject */ 13);\n\t\n\tvar _SectionObject2 = _interopRequireDefault(_SectionObject);\n\t\n\tvar _environment = __webpack_require__(/*! ./environment */ 7);\n\t\n\tvar _environment2 = _interopRequireDefault(_environment);\n\t\n\tvar _highlight = __webpack_require__(/*! ./highlight */ 19);\n\t\n\tvar _highlight2 = _interopRequireDefault(_highlight);\n\t\n\tvar _preview = __webpack_require__(/*! ./preview */ 18);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar selector = exports.selector = {};\n\t\n\tvar selected = new _SelectorMeta2.default();\n\tvar focused = new _SelectorMeta2.default();\n\t\n\tselector.placing = false;\n\t\n\tselector.getSelectedId = function () {\n\t\treturn selected.id;\n\t};\n\t\n\tselector.focus = function (meta) {\n\t\tvar obj;\n\t\n\t\tif (!meta.equals(focused)) {\n\t\t\tfocused = meta;\n\t\n\t\t\tif (!focused.isEmpty()) {\n\t\t\t\tobj = selector.getFocusedObject();\n\t\t\t\t_highlight2.default.focus(obj);\n\t\t\t}\n\t\t}\n\t};\n\t\n\tselector.selectFocused = function () {\n\t\tselector.select(focused);\n\t};\n\t\n\tselector.select = function (meta) {\n\t\tvar obj = getObject(meta);\n\t\n\t\tselector.unselect();\n\t\tselected = meta;\n\t\n\t\t_highlight2.default.select(obj);\n\t\t_highlight2.default.focus(null);\n\t\n\t\tselector.placing = false;\n\t};\n\t\n\tselector.unselect = function () {\n\t\tif (!selected.isEmpty()) {\n\t\t\t_highlight2.default.select(null);\n\t\t\tselected = new _SelectorMeta2.default();\n\t\t}\n\t\n\t\t_preview.preview.disable();\n\t};\n\t\n\tselector.getSelectedObject = function () {\n\t\treturn getObject(selected);\n\t};\n\t\n\tselector.getFocusedObject = function () {\n\t\treturn getObject(focused);\n\t};\n\t\n\tfunction getObject(meta) {\n\t\tvar object;\n\t\n\t\tif (!meta.isEmpty()) {\n\t\t\tobject = isShelf(meta) ? _environment2.default.getShelf(meta.parentId, meta.id) : isBook(meta) ? _environment2.default.getBook(meta.id) : isSection(meta) ? _environment2.default.getSection(meta.id) : null;\n\t\t}\n\t\n\t\treturn object;\n\t}\n\t\n\tselector.isSelectedEditable = function () {\n\t\treturn selector.isSelectedBook() || selector.isSelectedSection();\n\t};\n\t\n\tselector.isBookSelected = function (id) {\n\t\treturn isBook(selected) && selected.id === id;\n\t};\n\t\n\tselector.isSelectedShelf = function () {\n\t\treturn isShelf(selected);\n\t};\n\t\n\tselector.isSelectedBook = function () {\n\t\treturn isBook(selected);\n\t};\n\t\n\tselector.isSelectedSection = function () {\n\t\treturn isSection(selected);\n\t};\n\t\n\tfunction isShelf(meta) {\n\t\treturn meta.type === _ShelfObject2.default.TYPE;\n\t}\n\t\n\tfunction isBook(meta) {\n\t\treturn meta.type === _BookObject2.default.TYPE;\n\t}\n\t\n\tfunction isSection(meta) {\n\t\treturn meta.type === _SectionObject2.default.TYPE;\n\t}\n\n/***/ },\n/* 22 */\n/*!************************************!*\\\n  !*** ./src/models/SelectorMeta.js ***!\n  \\************************************/\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar SelectorMeta = (function () {\n\t\tfunction SelectorMeta(selectedObject) {\n\t\t\t_classCallCheck(this, SelectorMeta);\n\t\n\t\t\tif (selectedObject) {\n\t\t\t\tthis.id = selectedObject.getId();\n\t\t\t\tthis.parentId = selectedObject.parent.getId();\n\t\t\t\tthis.type = selectedObject.getType();\n\t\t\t}\n\t\t}\n\t\n\t\t_createClass(SelectorMeta, [{\n\t\t\tkey: \"isEmpty\",\n\t\t\tvalue: function isEmpty() {\n\t\t\t\treturn !this.id;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"equals\",\n\t\t\tvalue: function equals(meta) {\n\t\t\t\treturn !(!meta || meta.id !== this.id || meta.parentId !== this.parentId || meta.type !== this.type);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn SelectorMeta;\n\t})();\n\t\n\texports.default = SelectorMeta;\n\n/***/ },\n/* 23 */\n/*!***************************!*\\\n  !*** ./src/navigation.js ***!\n  \\***************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.navigation = undefined;\n\t\n\tvar _camera = __webpack_require__(/*! ./camera */ 15);\n\t\n\tvar _camera2 = _interopRequireDefault(_camera);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar navigation = exports.navigation = {};\n\t\n\tnavigation.BUTTONS_ROTATE_SPEED = 100;\n\tnavigation.BUTTONS_GO_SPEED = 0.02;\n\t\n\tvar state = {\n\t\tforward: false,\n\t\tbackward: false,\n\t\tleft: false,\n\t\tright: false\n\t};\n\t\n\tnavigation.goStop = function () {\n\t\tstate.forward = false;\n\t\tstate.backward = false;\n\t\tstate.left = false;\n\t\tstate.right = false;\n\t};\n\t\n\tnavigation.goForward = function () {\n\t\tstate.forward = true;\n\t};\n\t\n\tnavigation.goBackward = function () {\n\t\tstate.backward = true;\n\t};\n\t\n\tnavigation.goLeft = function () {\n\t\tstate.left = true;\n\t};\n\t\n\tnavigation.goRight = function () {\n\t\tstate.right = true;\n\t};\n\t\n\tnavigation.update = function () {\n\t\tif (state.forward) {\n\t\t\t_camera2.default.go(navigation.BUTTONS_GO_SPEED);\n\t\t} else if (state.backward) {\n\t\t\t_camera2.default.go(-navigation.BUTTONS_GO_SPEED);\n\t\t} else if (state.left) {\n\t\t\t_camera2.default.rotate(navigation.BUTTONS_ROTATE_SPEED, 0);\n\t\t} else if (state.right) {\n\t\t\t_camera2.default.rotate(-navigation.BUTTONS_ROTATE_SPEED, 0);\n\t\t}\n\t};\n\n/***/ },\n/* 24 */\n/*!***************************************!*\\\n  !*** ./src/models/SelectorMetaDto.js ***!\n  \\***************************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _SelectorMeta2 = __webpack_require__(/*! ./SelectorMeta */ 22);\n\t\n\tvar _SelectorMeta3 = _interopRequireDefault(_SelectorMeta2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar SelectorMetaDto = (function (_SelectorMeta) {\n\t\t_inherits(SelectorMetaDto, _SelectorMeta);\n\t\n\t\tfunction SelectorMetaDto(type, id, parentId) {\n\t\t\t_classCallCheck(this, SelectorMetaDto);\n\t\n\t\t\tvar _this = _possibleConstructorReturn(this, Object.getPrototypeOf(SelectorMetaDto).call(this));\n\t\n\t\t\t_this.type = type;\n\t\t\t_this.id = id;\n\t\t\t_this.parentId = parentId;\n\t\t\treturn _this;\n\t\t}\n\t\n\t\treturn SelectorMetaDto;\n\t})(_SelectorMeta3.default);\n\t\n\texports.default = SelectorMetaDto;\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** /bundle.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap e3dec9545ab1fa9a5bb7\n **/","/** @module lib3d*/\n\nimport THREE from 'three';\n\nimport camera from './camera';\nimport environment from './environment';\n\nexport {locator} from './locator';\nexport {mouse} from './mouse';\nexport {preview} from './preview';\nexport {selector} from './selector';\nexport {navigation} from './navigation';\n\nexport {default as ShelfObject} from './models/ShelfObject';\nexport {default as BookObject} from './models/BookObject';\nexport {default as SectionObject} from './models/SectionObject';\nexport {default as SelectorMeta} from './models/SelectorMeta';\nexport {default as SelectorMetaDto} from './models/SelectorMetaDto';\n\nvar loops = [];\nexport var renderer;\n\n/**\n * Inits lib3d, should be called first\n * @param {canvas} canvas - chould be provided for lib3d output\n */\nexport function init(canvas, width, height) {\n\trenderer = new THREE.WebGLRenderer({canvas: canvas || undefined, antialias: true});\n\trenderer.setSize(width, height);\n\t\n\tenvironment.scene = new THREE.Scene();\n\tenvironment.scene.fog = new THREE.Fog(0x000000, 4, 7);\n\n\tstartRenderLoop();\n}\n\n/**\n * Adds function to render loop\n * @param {function} func - function will be called on every render call\n */\nexport function addLoop(func) {\n\tloops.push(func);\n}\n\n//TODO: make separate loader module\n/**\n * Loads library by an object\n * @param {object} dto - full library structure\n */\nexport function load(dto) {\n\treturn environment.loadLibrary(dto);\n}\n\nfunction startRenderLoop() {\n\trequestAnimationFrame(startRenderLoop);\n\trenderer.render(environment.scene, camera.camera);\n\n\tloops.forEach(func => func());\n}\n\nexport {\n\tcamera,\n\tenvironment\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","import THREE from 'three';\n\nimport GridCalculator from './gridCalculator';\nimport BaseObject from './models/BaseObject';\n\nimport * as cache from './cache';\nimport environment from './environment';\n\nexport var locator = {};\n\nvar debugEnabled = false;\n\nlocator.centerObject = function(obj) {\n\tvar targetBB = obj.geometry.boundingBox;\n\tvar spaceBB = environment.library.geometry.boundingBox;\n\n\tvar matrixPrecision = new THREE.Vector3(targetBB.max.x - targetBB.min.x + 0.01, 0, targetBB.max.z - targetBB.min.z + 0.01);\n\tvar occupiedMatrix = getOccupiedMatrix(environment.library.children, matrixPrecision, obj);\n\tvar freePosition = getFreeMatrix(occupiedMatrix, spaceBB, targetBB, matrixPrecision);\t\t\n\n\tobj.position.setX(freePosition.x);\n\tobj.position.setZ(freePosition.z);\n};\n\nlocator.placeSection = function(sectionDto) {\n\treturn cache.getSection(sectionDto.model).then(function (sectionCache) {\n\t\tvar sectionBB = sectionCache.geometry.boundingBox;\n\t\tvar libraryBB = environment.library.geometry.boundingBox;\n\t\tvar freePlace = getFreePlace(environment.library.children, libraryBB, sectionBB);\n\n\t\tif (freePlace) {\n\t\t\treturn Promise.resolve(freePlace);\n\t\t} else {\n\t\t\treturn Promise.reject('there is no free space');\n\t\t}\n\t});\n};\n\nlocator.placeBook = function(bookDto, shelf) {\n\treturn cache.getBook(bookDto.model).then(function (bookCache) {\n\t\tvar shelfBB = shelf.geometry.boundingBox;\n\t\tvar bookBB = bookCache.geometry.boundingBox;\n\t\tvar freePlace = getFreePlace(shelf.children, shelfBB, bookBB);\n\n\t\treturn freePlace ?\n\t\t\tPromise.resolve(freePlace) :\n\t\t\tPromise.reject('there is no free space');\n\t});\n};\n\nfunction getFreePlace(objects, spaceBB, targetBB) {\n\tvar matrixPrecision = new THREE.Vector3(targetBB.max.x - targetBB.min.x + 0.01, 0, targetBB.max.z - targetBB.min.z + 0.01);\n\tvar occupiedMatrix = getOccupiedMatrix(objects, matrixPrecision);\n\tvar freePosition = getFreeMatrixCells(occupiedMatrix, spaceBB, targetBB, matrixPrecision);\n\t\n\tif (debugEnabled) {\n\t\tdebugShowFree(freePosition, matrixPrecision, environment.library);\n\t}\n\n\treturn freePosition;\n}\n\nfunction getFreeMatrix(occupiedMatrix, spaceBB, targetBB, matrixPrecision) {\n\tvar DISTANCE = 1.3;\n\n\tvar xIndex;\n\tvar zIndex;\n\tvar position = {};\n\tvar minPosition = {};\n\tvar edges = GridCalculator.getEdges(spaceBB, matrixPrecision);\n\n\tfor (zIndex = edges.minZCell; zIndex <= edges.maxZCell; zIndex++) {\n\t\tfor (xIndex = edges.minXCell; xIndex <= edges.maxXCell; xIndex++) {\n\t\t\tif (!occupiedMatrix[zIndex] || !occupiedMatrix[zIndex][xIndex]) {\n\t\t\t\tposition.pos = getPositionFromCells([xIndex], zIndex, matrixPrecision, spaceBB, targetBB);\n\t\t\t\tposition.length = position.pos.length();\n\n\t\t\t\tif(!minPosition.pos || position.length < minPosition.length) {\n\t\t\t\t\tminPosition.pos = position.pos;\n\t\t\t\t\tminPosition.length = position.length;\n\t\t\t\t}\n\n\t\t\t\tif(minPosition.pos && minPosition.length < DISTANCE) {\n\t\t\t\t\treturn minPosition.pos;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn minPosition.pos;\n}\n\nfunction getFreeMatrixCells(occupiedMatrix, spaceBB, targetBB, matrixPrecision) {\n\tvar targetCellsSize = 1;\n\tvar freeCellsCount = 0;\n\tvar freeCellsStart;\n\tvar xIndex;\n\tvar zIndex;\n\tvar cells;\n\tvar edges = GridCalculator.getEdges(spaceBB, matrixPrecision);\n\n\tfor (zIndex = edges.minZCell; zIndex <= edges.maxZCell; zIndex++) {\n\t\tfor (xIndex = edges.minXCell; xIndex <= edges.maxXCell; xIndex++) {\n\t\t\tif (!occupiedMatrix[zIndex] || !occupiedMatrix[zIndex][xIndex]) {\n\t\t\t\tfreeCellsStart = freeCellsStart || xIndex;\n\t\t\t\tfreeCellsCount++;\n\n\t\t\t\tif (freeCellsCount === targetCellsSize) {\n\t\t\t\t\tcells = _.range(freeCellsStart, freeCellsStart + freeCellsCount);\n\t\t\t\t\treturn getPositionFromCells(cells, zIndex, matrixPrecision, spaceBB, targetBB);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfreeCellsCount = 0;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn null;\n}\n\nfunction getPositionFromCells(cells, zIndex, matrixPrecision, spaceBB, targetBB) {\n\tvar center = GridCalculator.cellToPos(new THREE.Vector3(cells[0], 0, zIndex), matrixPrecision);\n\n\tvar offset = new THREE.Vector3();\n\toffset.addVectors(targetBB.min, targetBB.max);\n\toffset.multiplyScalar(-0.5);\n\n\treturn center.add(offset).setY(getBottomY(spaceBB, targetBB));\n}\n\nfunction getBottomY(spaceBB, targetBB) {\n\treturn spaceBB.min.y - targetBB.min.y + environment.CLEARANCE;\n}\n\nfunction getOccupiedMatrix(objects, matrixPrecision, obj) {\n\tvar result = {};\n\tvar objectBB;\n\tvar minKeyX;\n\tvar maxKeyX;\n\tvar minKeyZ;\n\tvar maxKeyZ;\t\t\n\tvar z, x;\n\n\tobjects.forEach(function (child) {\n\t\tif(child instanceof BaseObject && child !== obj) {\n\t\t\tobjectBB = child.boundingBox;\n\n\t\t\tminKeyX = Math.round((objectBB.center.x - objectBB.radius.x) / matrixPrecision.x);\n\t\t\tmaxKeyX = Math.round((objectBB.center.x + objectBB.radius.x) / matrixPrecision.x);\n\t\t\tminKeyZ = Math.round((objectBB.center.z - objectBB.radius.z) / matrixPrecision.z);\n\t\t\tmaxKeyZ = Math.round((objectBB.center.z + objectBB.radius.z) / matrixPrecision.z);\n\n\t\t\tfor(z = minKeyZ; z <= maxKeyZ; z++) {\n\t\t\t\tresult[z] = result[z] || {};\n\t\t\t\tvar debugCells = [];\n\n\t\t\t\tfor(x = minKeyX; x <= maxKeyX; x++) {\n\t\t\t\t\tresult[z][x] = true;\n\t\t\t\t\tdebugCells.push(x);\n\t\t\t\t}\n\n\t\t\t\tif(debugEnabled) {\n\t\t\t\t\tdebugShowBB(child);\n\t\t\t\t\tdebugAddOccupied(debugCells, matrixPrecision, child, z);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\treturn result;\n}\n\nlocator.debug = function() {\n\tcache.getSection('bookshelf_0001').then(function (sectionCache) {\n\t\tdebugEnabled = true;\n\t\tvar sectionBB = sectionCache.geometry.boundingBox;\n\t\tvar libraryBB = environment.library.geometry.boundingBox;\n\t\tgetFreePlace(environment.library.children, libraryBB, sectionBB);\n\t\tdebugEnabled = false;\n\t});\n};\n\nfunction debugShowBB(obj) {\n\tvar objectBB = obj.boundingBox;\n\tvar objBox = new THREE.Mesh(\n\t\tnew THREE.BoxGeometry(\n\t\t\tobjectBB.radius.x * 2, \n\t\t\tobjectBB.radius.y * 2 + 0.1, \n\t\t\tobjectBB.radius.z * 2\n\t\t), \n\t\tnew THREE.MeshLambertMaterial({\n\t\t\tcolor: 0xbbbbff,\n\t\t\topacity: 0.2,\n\t\t\ttransparent: true\n\t\t})\n\t);\n\t\n\tobjBox.position.x = objectBB.center.x;\n\tobjBox.position.y = objectBB.center.y;\n\tobjBox.position.z = objectBB.center.z;\n\n\tobj.parent.add(objBox);\n}\n\nfunction debugAddOccupied(cells, matrixPrecision, obj, zKey) {\n\tcells.forEach(function (cell) {\n\t\tvar pos = getPositionFromCells([cell], zKey, matrixPrecision, obj.parent.geometry.boundingBox, obj.geometry.boundingBox);\n\t\tvar cellBox = new THREE.Mesh(new THREE.BoxGeometry(matrixPrecision.x - 0.01, 0.01, matrixPrecision.z - 0.01), new THREE.MeshLambertMaterial({color: 0xff0000}));\n\t\t\n\t\tcellBox.position.set(pos.x, pos.y, pos.z);\n\t\tobj.parent.add(cellBox);\n\t});\n}\n\nfunction debugShowFree(position, matrixPrecision, obj) {\n\tif (position) {\n\t\tvar cellBox = new THREE.Mesh(new THREE.BoxGeometry(matrixPrecision.x, 0.5, matrixPrecision.z), new THREE.MeshLambertMaterial({color: 0x00ff00}));\n\t\tcellBox.position.set(position.x, position.y, position.z);\n\t\tobj.parent.add(cellBox);\n\t}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/locator.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"three\"\n ** module id = 2\n ** module chunks = 0\n **/","export default class GridCalculator {\n\tstatic getEdges(spaceBB, precision) {\n\t\tvar posMin = this.posToCell(spaceBB.min, precision);\n\t\tvar posMax = this.posToCell(spaceBB.max, precision);\n\t\t\n\t\treturn {\n\t\t\tminXCell: posMin.x + 1,\n\t\t\tmaxXCell: posMax.x - 1,\n\t\t\tminZCell: posMin.z + 1,\n\t\t\tmaxZCell: posMax.z - 1\n\t\t};\n\t}\n\n\tstatic posToCell(pos, precision) {\n\t\treturn pos.clone().divide(precision).round();\n\t}\n\n\tstatic cellToPos(cell, precision) {\n\t\treturn cell.clone().multiply(precision);\n\t}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/gridCalculator.js\n **/","import THREE from 'three';\n\nexport default class BaseObject extends THREE.Mesh {\n\tconstructor(dataObject, geometry, material) {\n\t\tsuper(geometry, material);\n\n\t\tthis.dataObject = dataObject || {};\n\t\tthis.rotation.order = 'XYZ';\n\t\tthis.setDtoTransformations();\n\t}\n\t\n\tgetType() {\n\t\treturn this.vbType;\n\t}\n\n\tgetId() {\n\t\treturn this.dataObject && this.dataObject.id;\n\t}\n\n\tsetDtoTransformations() {\n\t\tthis.position.setX(this.dataObject.pos_x || 0);\n\t\tthis.position.setY(this.dataObject.pos_y || 0);\n\t\tthis.position.setZ(this.dataObject.pos_z || 0);\n\n\t\tif(this.dataObject.rotation) this.rotation.fromArray(this.dataObject.rotation.map(Number));\n\n\t\tthis.updateBoundingBox();\t\t\n\t}\n\n\tisOutOfParrent() {\n\t\treturn Math.abs(this.boundingBox.center.x - this.parent.boundingBox.center.x) > (this.parent.boundingBox.radius.x - this.boundingBox.radius.x) ||\n\t\t\t\tMath.abs(this.boundingBox.center.z - this.parent.boundingBox.center.z) > (this.parent.boundingBox.radius.z - this.boundingBox.radius.z);\n\t}\n\n\tisCollided() {\n\t\tvar\n\t\t\tresult,\n\t\t\ttargets,\n\t\t\ttarget,\n\t\t\ti;\n\n\t\tthis.updateBoundingBox();\n\n\t\tresult = this.isOutOfParrent();\n\t\ttargets = this.parent.children;\n\n\t\tif(!result) {\n\t\t\tfor(i = targets.length - 1; i >= 0; i--) {\n\t\t\t\ttarget = targets[i].boundingBox;\n\n\t\t\t\tif(targets[i] === this ||\n\t\t\t\t\t!target || // children without BB\n\t\t\t\t\t(Math.abs(this.boundingBox.center.x - target.center.x) > (this.boundingBox.radius.x + target.radius.x)) ||\n\t\t\t\t\t(Math.abs(this.boundingBox.center.y - target.center.y) > (this.boundingBox.radius.y + target.radius.y)) ||\n\t\t\t\t\t(Math.abs(this.boundingBox.center.z - target.center.z) > (this.boundingBox.radius.z + target.radius.z))) {\t\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t    \tresult = true;\t\t\n\t\t    \tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tmove(newPosition) {\n\t\tvar \n\t\t\tcurrentPosition,\n\t\t\tresult;\n\n\t\tresult = false;\n\t\tcurrentPosition = this.position.clone();\n\t\t\n\t\tif(newPosition.x) {\n\t\t\tthis.position.setX(newPosition.x);\n\n\t\t\tif(this.isCollided()) {\n\t\t\t\tthis.position.setX(currentPosition.x);\n\t\t\t} else {\n\t\t\t\tresult = true;\n\t\t\t}\n\t\t}\n\n\t\tif(newPosition.z) {\n\t\t\tthis.position.setZ(newPosition.z);\n\n\t\t\tif(this.isCollided()) {\n\t\t\t\tthis.position.setZ(currentPosition.z);\n\t\t\t} else {\n\t\t\t\tresult = true;\n\t\t\t}\n\t\t}\n\n\t\tthis.changed = this.changed || result;\n\t\tthis.updateBoundingBox();\n\n\t\treturn result;\n\t}\n\n\trotate(dX, dY, isDemo) {\n\t\tvar \n\t\t\tcurrentRotation = this.rotation.clone(),\n\t\t\tresult = false; \n\t\t\n\t\tif(dX) {\n\t\t\tthis.rotation.y += dX * 0.01;\n\n\t\t\tif(!isDemo && this.isCollided()) {\n\t\t\t\tthis.rotation.y = currentRotation.y;\n\t\t\t} else {\n\t\t\t\tresult = true;\n\t\t\t}\n\t\t}\n\n\t\tif(dY) {\n\t\t\tthis.rotation.x += dY * 0.01;\n\n\t\t\tif(!isDemo && this.isCollided()) {\n\t\t\t\tthis.rotation.x = currentRotation.x;\n\t\t\t} else {\n\t\t\t\tresult = true;\n\t\t\t}\n\t\t}\n\n\t\tthis.changed = this.changed || (!isDemo && result);\n\t\tthis.updateBoundingBox();\n\t}\n\n\tupdateBoundingBox() {\n\t\tvar\n\t\t\tboundingBox,\n\t\t\tradius,\n\t\t\tcenter;\n\n\t\tthis.updateMatrix();\n\t\tboundingBox = this.geometry.boundingBox.clone().applyMatrix4(this.matrix);\n\t\t\n\t\tradius = {\n\t\t\tx: (boundingBox.max.x - boundingBox.min.x) * 0.5,\n\t\t\ty: (boundingBox.max.y - boundingBox.min.y) * 0.5,\n\t\t\tz: (boundingBox.max.z - boundingBox.min.z) * 0.5\n\t\t};\n\n\t\tcenter = new THREE.Vector3();\n\t\tcenter.addVectors(boundingBox.min, boundingBox.max);\n\t\tcenter.multiplyScalar(0.5);\n\n\t\tthis.boundingBox = {\n\t\t\tradius: radius,\n\t\t\tcenter: center\n\t\t};\n\t}\n\n\trollback() {\n\t\tthis.setDtoTransformations();\n\t}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/models/BaseObject.js\n **/","import * as repository from './repository';\n\nvar library = null;\nvar sections = {};\nvar books = {};\n\nexport function init(libraryModel, sectionModels, bookModels) {\n\tvar libraryLoad = repository.loadLibraryData(libraryModel);\n\tvar sectionsLoad = [];\n\tvar booksLoad = [];\n\tvar model; // iterators\n\n\tfor (model in sectionModels) {\n\t\tsectionsLoad.push(addSection(model));\n\t}\n\n\tfor (model in bookModels) {\n\t\tbooksLoad.push(addBook(model));\n\t}\n\n\treturn Promise.all([\n\t\tlibraryLoad, \n\t\tPromise.all(sectionsLoad), \n\t\tPromise.all(booksLoad)\n\t]).then(results => {\n\t\tlibrary = results[0];\n\t});\n}\n\nexport function getLibrary() {\n\treturn library;\n}\n\nexport function getSection(model) {\n\treturn commonGetter(sections, model, addSection);\n}\n\nexport function getBook(model) {\n\treturn commonGetter(books, model, addBook);\n}\n\nfunction addSection(model) {\n\treturn commonAdder(sections, model, repository.loadSectionData);\n}\n\nfunction addBook(model) {\n\treturn commonAdder(books, model, repository.loadBookData);\n}\n\nfunction commonGetter(from, key, addFunction) {\n\tvar result = from[key];\n\n\tif(!result) {\n\t\tresult = addFunction(key);\n\t}\n\n\treturn Promise.resolve(result);\n}\n\nfunction commonAdder(where, what, loader) {\n\tvar promise = loader(what).then(function (loadedCache) {\n\t\twhere[what] = loadedCache;\n\n\t\treturn loadedCache;\n\t});\n\n\treturn promise;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/cache.js\n **/","import THREE from 'three';\n\nvar jsonLoader = new THREE.JSONLoader();\nvar dataLoader = new THREE.XHRLoader();\ndataLoader.setResponseType('json');\n\nexport function loadLibraryData(model) {\n\tvar path = `/obj/libraries/${model}`;\n    var modelUrl = `${path}/model.json`;\n    var mapUrl = `${path}/map.jpg`;\n\n    return Promise.all([\n    \tloadGeometry(modelUrl),\n    \tloadImage(mapUrl)\n    ]).then(results => ({\n    \tgeometry: results[0],\n    \tmapImage: results[1]\n    }));\n}\n\nexport function loadSectionData(model) {\n\tvar path = `/obj/sections/${model}`;\n    var modelUrl = `${path}/model.js`;\n    var mapUrl = `${path}/map.jpg`;\n    var dataUrl = `${path}/data.json`;\n\n    return Promise.all([\n    \tloadGeometry(modelUrl), \n    \tloadImage(mapUrl), \n    \tloadData(dataUrl)\n    ]).then(sectionData => ({\n\t\tgeometry: sectionData[0],\n\t\tmapImage: sectionData[1],\n\t\tdata: sectionData[2]\n    }));\n}\n\nexport function loadBookData(model) {\n\tvar path = `/obj/books/${model}`;\n    var modelUrl = `${path}/model.js`;\n    var mapUrl = `${path}/map.jpg`;\n    var bumpMapUrl = `${path}/bump_map.jpg`;\n    var specularMapUrl = `${path}/specular_map.jpg`;\n\n    return  Promise.all([\n    \tloadGeometry(modelUrl),\n    \tloadImage(mapUrl).catch(() => {\n    \t\tconsole.error('repository: Error loading book map:', model);\n    \t\treturn null;\n    \t}),\n    \tloadImage(bumpMapUrl).catch(() => {\n    \t\tconsole.error('repository: Error loading book bumpMap:', model);\n    \t\treturn null;\n    \t}),\n    \tloadImage(specularMapUrl).catch(() => {\n    \t\tconsole.error('repository: Error loading book specularMap:', model);\n    \t\treturn null;\n    \t})\n    ]).then(results => ({\n    \tgeometry: results[0],\n    \tmapImage: results[1],\n    \tbumpMapImage: results[2],\n    \tspecularMapImage: results[3]\n    }));\n}\n\nfunction loadGeometry(url) {\n\treturn new Promise((resolve, reject) => {\n\t\tjsonLoader.load(url, geometry => {\n\t\t\tgeometry.computeBoundingBox();\n\t\t\tresolve(geometry);\n\t\t}, () => {}, reject);\n\t});\n}\n\nexport function loadImage(url) {\n    var img = new Image();\n        \n    img.crossOrigin = ''; \n    img.src = url;\n\n    return new Promise((resolve, reject) => {\n    \timg.onload = function() {\n    \t\tresolve(img);\n    \t};\n\n    \timg.onerror = function(err) {\n    \t\treject(err);\n    \t};\n    });\n}\n\nfunction loadData(url) {\n\treturn new Promise((resolve, reject) => {\n\t\tdataLoader.load(url, resolve, () => {}, reject);\n\t});\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/repository.js\n **/","import THREE from 'three';\n\nimport BookMaterial from './materials/BookMaterial';\nimport LibraryObject from './models/LibraryObject';\nimport BookObject from './models/BookObject';\nimport SectionObject from './models/SectionObject';\n\nimport camera from './camera';\nimport {locator} from './locator';\nimport * as cache from './cache';\nimport * as repository from './repository';\n\nvar environment = {};\n\nenvironment.CLEARANCE = 0.001;\n \nvar libraryDto = null;\nvar sections = {};\nvar books = {};\n\nenvironment.scene = null;\nenvironment.library = null;\n\nenvironment.loadLibrary = function(dto) {\n\tclearScene(); // inits some fields\n\n\tvar dict = parseLibraryDto(dto);\n\t\t\n\tsections = dict.sections;\n\tbooks = dict.books;\n\tlibraryDto = dto;\n\n\treturn initCache(libraryDto, dict.sections, dict.books)\n\t.then(function () {\n\t\tcreateLibrary(libraryDto);\n\t\treturn createSections(sections);\n\t})\n\t.then(function () {\n\t\treturn locator.centerObject(camera.object);\n\t})\n\t.then(function () {\n\t\treturn createBooks(books);\n\t});\n};\n\nenvironment.getBook = function(bookId) {\n\treturn getDictObject(books, bookId);\n};\n\nenvironment.getSection = function(sectionId) {\n\treturn getDictObject(sections, sectionId);\n};\n\nenvironment.getShelf = function(sectionId, shelfId) {\n\tvar section = environment.getSection(sectionId);\n\tvar shelf = section && section.shelves[shelfId];\n\n\treturn shelf;\n};\n\nenvironment.updateSection = function(dto) {\n\tif(dto.libraryId == environment.library.getId()) {\n\t\tenvironment.removeSection(dto.id);\n\t\treturn createSection(dto);\n\t} else {\n\t\tenvironment.removeSection(dto.id);\n\t\treturn Promise.resolve(dto);\n\t}\n};\n\nenvironment.updateBook = function(dto) {\n\tif(getBookShelf(dto)) {\n\t\tenvironment.removeBook(dto.id);\n\t\treturn createBook(dto);\n\t} else {\n\t\tenvironment.removeBook(dto.id);\n\t\treturn Promise.resolve(true);\n\t}\n};\n\nenvironment.removeBook = function(id) {\n\tremoveObject(books, id);\n};\n\nenvironment.removeSection = function(id) {\n\tremoveObject(sections, id);\n};\n\nfunction removeObject(dict, key) {\n\tvar dictItem = dict[key];\n\tif(dictItem) {\n\t\tdelete dict[key];\n\t\t\n\t\tif(dictItem.obj) {\n\t\t\tdictItem.obj.setParent(null);\n\t\t}\n\t}\n}\n\nfunction initCache(libraryDto, sectionsDict, booksDict) {\n\tvar libraryModel = libraryDto.model;\n\tvar sectionModels = {};\n\tvar bookModels = {};\n\n\tfor (var sectionId in sectionsDict) {\n\t\tvar sectionDto = sectionsDict[sectionId].dto;\n\t\tsectionModels[sectionDto.model] = true;\n\t}\n\n\tfor (var bookId in booksDict) {\n\t\tvar bookDto = booksDict[bookId].dto;\n\t\tbookModels[bookDto.model] = true;\n\t}\n\n\treturn cache.init(libraryModel, sectionModels, bookModels);\n}\n\nfunction clearScene() {\n\tenvironment.library = null;\n\tsections = {};\n\tbooks = {};\n\n\twhile(environment.scene.children.length > 0) {\n\t\tif(environment.scene.children[0].dispose) {\n\t\t\tenvironment.scene.children[0].dispose();\n\t\t}\n\t\tenvironment.scene.remove(environment.scene.children[0]);\n\t}\n}\n\nfunction parseLibraryDto(libraryDto) {\n\tvar result = {\n\t\tsections: {},\n\t\tbooks: {}\n\t};\n\n\tfor(var sectionIndex = libraryDto.sections.length - 1; sectionIndex >= 0; sectionIndex--) {\n\t\tvar sectionDto = libraryDto.sections[sectionIndex];\n\t\tresult.sections[sectionDto.id] = {dto: sectionDto};\n\n\t\tfor(var bookIndex = sectionDto.books.length - 1; bookIndex >= 0; bookIndex--) {\n\t\t\tvar bookDto = sectionDto.books[bookIndex];\n\t\t\tresult.books[bookDto.id] = {dto: bookDto};\n\t\t}\n\n\t\tdelete sectionDto.books;\n\t}\n\n\tdelete libraryDto.sections;\n\n\treturn result;\n}\n\nfunction createLibrary(libraryDto) {\n\tvar library = null;\n\tvar libraryCache = cache.getLibrary();\n    var texture = new THREE.Texture(libraryCache.mapImage);\n    var material = new THREE.MeshPhongMaterial({map: texture});\n\n    texture.needsUpdate = true;\n\tlibrary = new LibraryObject(libraryDto, libraryCache.geometry, material);\n\n\tlibrary.add(new THREE.AmbientLight(0x333333));\n\tcamera.setParent(library);\n\t\n\tenvironment.scene.add(library);\n\tenvironment.library = library;\n}\n\nfunction createSections(sectionsDict) {\n\treturn createObjects(sectionsDict, createSection);\n}\n\nfunction createBooks(booksDict) {\n\treturn createObjects(booksDict, createBook);\n}\n\nfunction createObjects(dict, factory) {\n\tvar results = [];\n\tvar key;\n\n\tfor(key in dict) {\n\t\tresults.push(factory(dict[key].dto));\n\t}\n\n\treturn Promise.all(results);\n}\n\nfunction createSection(sectionDto) {\n\tvar promise = cache.getSection(sectionDto.model).then(function (sectionCache) {\n        var texture = new THREE.Texture(sectionCache.mapImage);\n        var material = new THREE.MeshPhongMaterial({map: texture});\n        var section;\n\n        texture.needsUpdate = true;\n        sectionDto.data = sectionCache.data;\n\n        section = new SectionObject(sectionDto, sectionCache.geometry, material);\n\n\t\tenvironment.library.add(section);\n\t\taddToDict(sections, section);\n\n\t\treturn sectionDto;\n\t});\n\n\treturn promise;\n}\n\nfunction createBook(bookDto) {\n\treturn Promise.all([\n\t\tcache.getBook(bookDto.model),\n\t\tbookDto.cover ? repository.loadImage(bookDto.cover.url) : Promise.resolve(null)\n\t]).then(function (results) {\n\t\tvar bookCache = results[0];\n\t\tvar coverMapImage = results[1];\n\t\tvar material = new BookMaterial(bookCache.mapImage, bookCache.bumpMapImage, bookCache.specularMapImage, coverMapImage);\n\t\tvar book = new BookObject(bookDto, bookCache.geometry, material);\n\n\t\taddToDict(books, book);\n\t\tplaceBookOnShelf(book);\n\t});\n}\n\nfunction addToDict(dict, obj) {\n\tvar dictItem = {\n\t\tdto: obj.dataObject,\n\t\tobj: obj\n\t};\n\n\tdict[obj.getId()] = dictItem;\n}\n\nfunction getDictObject(dict, objectId) {\n\tvar dictItem = dict[objectId];\n\tvar dictObject = dictItem && dictItem.obj;\n\n\treturn dictObject;\n}\n\nfunction getBookShelf(bookDto) {\n\treturn environment.getShelf(bookDto.sectionId, bookDto.shelfId);\n}\n\nfunction placeBookOnShelf(book) {\n\tvar shelf = getBookShelf(book.dataObject);\n\tshelf.add(book);\n}\n\nexport default environment;\n\n\n/** WEBPACK FOOTER **\n ** ./src/environment.js\n **/","import THREE from 'three';\n\nvar vertexShader = require('./shaders/BookMaterial.vs');\nvar fragmentShader = require('./shaders/BookMaterial.fs');\n\nexport default class BookMaterial extends THREE.ShaderMaterial {\n\tconstructor(mapImage, bumpMapImage, specularMapImage, coverMapImage) {\n\t\tvar defines = {};\n\t\tvar uniforms;\n\t\tvar parameters;\n\n        var map;\n        var bumpMap;\n        var specularMap;\n        var coverMap;\n\t\t\n\t\tuniforms = THREE.UniformsUtils.merge([\n\t\t\tTHREE.UniformsLib.common,\n\t\t\tTHREE.UniformsLib.bump,\n\t\t\tTHREE.UniformsLib.fog,\n\t\t\tTHREE.UniformsLib.lights\n\t\t]);\n\n\t\tuniforms.shininess = {type: 'f', value: 30};\n\t\tdefines.PHONG = true;\n\n\t\tif(mapImage) {\n\t\t\tmap = new THREE.Texture(mapImage);\n\t\t\tmap.needsUpdate = true;\n\t\t\tuniforms.map = {type: 't', value: map};\n\t\t}\n\n\t\tif(bumpMapImage) {\n\t\t\tbumpMap = new THREE.Texture(bumpMapImage);\n\t\t\tbumpMap.needsUpdate = true;\n\t\t\tuniforms.bumpMap = {type: 't', value: bumpMap};\n\t\t\tuniforms.bumpScale.value = 0.005;\n\t\t}\n\n\t\tif(specularMapImage) {\n\t\t\tspecularMap = new THREE.Texture(specularMapImage);\n\t\t\tspecularMap.needsUpdate = true;\n\t\t\tuniforms.specular = {type: 'c', value: new THREE.Color(0x555555)};\n\t\t\tuniforms.specularMap = {type: 't', value: specularMap};\n\t\t}\n\n        if(coverMapImage) {\n\t\t\tcoverMap = new THREE.Texture(coverMapImage);\n\t\t\tcoverMap.needsUpdate = true;\n\t\t\tuniforms.coverMap = {type: 't', value: coverMap};\n\t\t\tdefines.USE_COVER = true;\n        }\n\n\t\tparameters = {\n\t\t\tvertexShader: vertexShader,\n\t\t\tfragmentShader: fragmentShader,\n\t\t\tuniforms: uniforms,\n\t\t\tdefines: defines,\n\t\t\tlights: true,\n\t\t\tfog: true\n\t\t};\n\n\t\tsuper(parameters);\n\n\t\tthis.map = !!mapImage;\n\t\tthis.bumpMap = !!bumpMapImage;\n\t\tthis.specularMap = !!specularMapImage;\t\t\n\t}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/materials/BookMaterial.js\n **/","module.exports = \"varying vec3 vViewPosition;\\nvarying vec3 vNormal;\\n\\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\\n\\tvarying vec2 vUv;\\n\\tuniform vec4 offsetRepeat;\\n#endif\\n\\n#ifndef PHONG_PER_PIXEL\\n\\t#if MAX_POINT_LIGHTS > 0\\n\\t\\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\\t\\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\\t\\tvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\\n\\t#endif\\n\\n\\t#if MAX_SPOT_LIGHTS > 0\\n\\t\\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\\t\\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\\t\\tvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\\n\\t#endif\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\\n\\tvarying vec3 vWorldPosition;\\n#endif\\n\\n#ifdef USE_COLOR\\n\\tvarying vec3 vColor;\\n#endif\\n\\nvoid main() {\\n\\t#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\\n\\t\\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\\n\\t#endif\\n\\n\\t#ifdef USE_COLOR\\n\\t\\t#ifdef GAMMA_INPUT\\n\\t\\t\\tvColor = color * color;\\n\\t\\t#else\\n\\t\\t\\tvColor = color;\\n\\t\\t#endif\\n\\t#endif\\n\\n\\tvec3 objectNormal;\\n\\t#ifdef USE_SKINNING\\n\\t\\tobjectNormal = skinnedNormal.xyz;\\n\\t#endif\\n\\n\\t#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\\n\\t\\tobjectNormal = morphedNormal;\\n\\t#endif\\n\\n\\t#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\\n\\t\\tobjectNormal = normal;\\n\\t#endif\\n\\n\\t#ifdef FLIP_SIDED\\n\\t\\tobjectNormal = -objectNormal;\\n\\t#endif\\n\\n\\tvec3 transformedNormal = normalMatrix * objectNormal;\\n\\tvNormal = normalize(transformedNormal);\\n\\tvec4 mvPosition;\\n\\t#ifdef USE_SKINNING\\n\\t\\tmvPosition = modelViewMatrix * skinned;\\n\\t#endif\\n\\n\\t#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\\n\\t\\tmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\\n\\t#endif\\n\\n\\t#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\\n\\t\\tmvPosition = modelViewMatrix * vec4( position, 1.0 );\\n\\t#endif\\n\\n\\tgl_Position = projectionMatrix * mvPosition;\\n\\tvViewPosition = -mvPosition.xyz;\\n\\t#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\\n\\t\\t#ifdef USE_SKINNING\\n\\t\\t\\tvec4 worldPosition = modelMatrix * skinned;\\n\\t\\t#endif\\n\\n\\t\\t#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\\n\\t\\t\\tvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\\n\\t\\t#endif\\n\\n\\t\\t#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\\n\\t\\t\\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\\n\\t\\t#endif\\n\\t#endif\\n\\n\\t#ifndef PHONG_PER_PIXEL\\n\\t\\t#if MAX_POINT_LIGHTS > 0\\n\\t\\t\\tfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\t\\t\\t\\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\\n\\t\\t\\t\\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\\n\\t\\t\\t\\tfloat lDistance = 1.0;\\n\\n\\t\\t\\t\\tif ( pointLightDistance[ i ] > 0.0 )\\n\\t\\t\\t\\t\\tlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\\n\\t\\t\\t\\t\\tvPointLight[ i ] = vec4( lVector, lDistance );\\n\\t\\t\\t}\\n\\t\\t#endif\\n\\n\\t\\t#if MAX_SPOT_LIGHTS > 0\\n\\t\\t\\tfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\t\\t\\t\\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\\n\\t\\t\\t\\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\\n\\t\\t\\t\\tfloat lDistance = 1.0;\\n\\n\\t\\t\\t\\tif ( spotLightDistance[ i ] > 0.0 )\\n\\t\\t\\t\\t\\tlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\\n\\t\\t\\t\\t\\tvSpotLight[ i ] = vec4( lVector, lDistance );\\n\\t\\t\\t}\\n\\t\\t#endif\\n\\t#endif\\n\\n\\t#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\\n\\t\\tvWorldPosition = worldPosition.xyz;\\n\\t#endif\\n}\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/materials/shaders/BookMaterial.vs\n ** module id = 9\n ** module chunks = 0\n **/","module.exports = \"uniform vec3 diffuse;\\nuniform float opacity;\\nuniform vec3 emissive;\\nuniform vec3 specular;\\nuniform float shininess;\\nuniform sampler2D coverMap;\\n\\n#ifdef USE_COLOR\\n\\tvarying vec3 vColor;\\n#endif\\n\\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\\n\\tvarying vec2 vUv;\\n#endif\\n\\n#ifdef USE_MAP\\n\\tuniform sampler2D map;\\n#endif\\n\\n#ifdef USE_FOG\\n\\tuniform vec3 fogColor;\\n\\n\\t#ifdef FOG_EXP2\\n\\t\\tuniform float fogDensity;\\n\\t#else\\n\\t\\tuniform float fogNear;\\n\\t\\tuniform float fogFar;\\n\\t#endif\\n#endif\\n\\nuniform vec3 ambientLightColor;\\n#if MAX_DIR_LIGHTS > 0\\n\\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\\t#ifdef PHONG_PER_PIXEL\\n\\t\\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\\t\\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\\t#else\\n\\t\\tvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\\n\\t#endif\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\\t#ifdef PHONG_PER_PIXEL\\n\\t\\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\\t#else\\n\\t\\tvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\\n\\t#endif\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\\n\\tvarying vec3 vWorldPosition;\\n#endif\\n\\n#ifdef WRAP_AROUND\\n\\tuniform vec3 wrapRGB;\\n#endif\\n\\nvarying vec3 vViewPosition;\\nvarying vec3 vNormal;\\n#ifdef USE_BUMPMAP\\n\\tuniform sampler2D bumpMap;\\n\\tuniform float bumpScale;\\n\\tvec2 dHdxy_fwd() {\\n\\t\\tvec2 dSTdx = dFdx( vUv );\\n\\t\\tvec2 dSTdy = dFdy( vUv );\\n\\t\\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\\t\\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\\t\\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\t\\treturn vec2( dBx, dBy );\\n\\t}\\n\\n\\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\t\\tvec3 vSigmaX = dFdx( surf_pos );\\n\\t\\tvec3 vSigmaY = dFdy( surf_pos );\\n\\t\\tvec3 vN = surf_norm;\\n\\t\\tvec3 R1 = cross( vSigmaY, vN );\\n\\t\\tvec3 R2 = cross( vN, vSigmaX );\\n\\t\\tfloat fDet = dot( vSigmaX, R1 );\\n\\t\\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\\t\\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\t}\\n#endif\\n\\n#ifdef USE_SPECULARMAP\\n\\tuniform sampler2D specularMap;\\n#endif\\n\\nvoid main() {\\n\\tvec4 testcolor = vec4(1.0, 1.0, 1.0, 1.0);\\n\\tfloat eps = 0.004;\\n\\tvec4 baseColor  = texture2D(map, vUv);\\n\\t#ifdef USE_COVER\\n\\t\\tvec4 coverColor = texture2D(coverMap, vUv * vec2(2.3, 1.3) - vec2(1.3, 0.3));\\n\\t\\tif(vUv.y > 0.23 && (vUv.x > 0.57 || (all(greaterThanEqual(baseColor,testcolor-eps)) && all(lessThanEqual(baseColor,testcolor+eps)))))\\n\\t\\t\\tgl_FragColor = coverColor;\\n\\t\\telse\\n\\t\\t\\tgl_FragColor = baseColor;\\n\\t#else\\n\\t\\tgl_FragColor = baseColor;\\n\\t#endif\\n\\n\\tfloat specularStrength;\\n\\t#ifdef USE_SPECULARMAP\\n\\t\\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\\t\\tspecularStrength = texelSpecular.r;\\n\\t#else\\n\\t\\tspecularStrength = 1.0;\\n\\t#endif\\n\\n\\tvec3 normal = normalize( vNormal );\\n\\tvec3 viewPosition = normalize( vViewPosition );\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\\t#endif\\n\\n\\t#ifdef USE_NORMALMAP\\n\\t\\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n\\t#elif defined( USE_BUMPMAP )\\n\\t\\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n\\t#endif\\n\\n\\t#if MAX_POINT_LIGHTS > 0\\n\\t\\tvec3 pointDiffuse  = vec3( 0.0 );\\n\\t\\tvec3 pointSpecular = vec3( 0.0 );\\n\\n\\t\\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\t\\t\\t#ifdef PHONG_PER_PIXEL\\n\\t\\t\\t\\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\\n\\t\\t\\t\\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\\n\\t\\t\\t\\tfloat lDistance = 1.0;\\n\\t\\t\\t\\n\\t\\t\\t\\tif ( pointLightDistance[ i ] > 0.0 )\\n\\t\\t\\t\\t\\tlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\\n\\t\\t\\t\\tlVector = normalize( lVector );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec3 lVector = normalize( vPointLight[ i ].xyz );\\n\\t\\t\\t\\tfloat lDistance = vPointLight[ i ].w;\\n\\t\\t\\t#endif\\n\\n\\t\\t\\tfloat dotProduct = dot( normal, lVector );\\n\\t\\t\\t#ifdef WRAP_AROUND\\n\\t\\t\\t\\tfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\\n\\t\\t\\t\\tfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\t\\t\\t\\tvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tfloat pointDiffuseWeight = max( dotProduct, 0.0 );\\n\\t\\t\\t#endif\\n\\n\\t\\t\\tpointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\\n\\t\\t\\tvec3 pointHalfVector = normalize( lVector + viewPosition );\\n\\t\\t\\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\\n\\t\\t\\tfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\\n\\n\\t\\t\\t#ifdef PHYSICALLY_BASED_SHADING\\n\\t\\t\\t\\tfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\\n\\t\\t\\t\\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\\n\\t\\t\\t\\tpointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\\n\\t\\t\\t#else\\n\\t\\t\\t\\tpointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\\n\\t\\t\\t#endif\\n\\t\\t}\\n\\t#endif\\n\\n\\t#if MAX_SPOT_LIGHTS > 0\\n\\t\\tvec3 spotDiffuse  = vec3( 0.0 );\\n\\t\\tvec3 spotSpecular = vec3( 0.0 );\\n\\t\\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\t\\t\\t#ifdef PHONG_PER_PIXEL\\n\\t\\t\\t\\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\\n\\t\\t\\t\\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\\n\\t\\t\\t\\tfloat lDistance = 1.0;\\n\\n\\t\\t\\t\\tif ( spotLightDistance[ i ] > 0.0 )\\n\\t\\t\\t\\t\\tlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );-\\n\\n\\t\\t\\t\\tlVector = normalize( lVector );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec3 lVector = normalize( vSpotLight[ i ].xyz );\\n\\t\\t\\t\\tfloat lDistance = vSpotLight[ i ].w;\\n\\t\\t\\t#endif\\n\\n\\t\\t\\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\\n\\t\\t\\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\t\\t\\t\\tspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\\n\\t\\t\\t\\tfloat dotProduct = dot( normal, lVector );\\n\\n\\t\\t\\t\\t#ifdef WRAP_AROUND\\n\\t\\t\\t\\t\\tfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\\n\\t\\t\\t\\t\\tfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\t\\t\\t\\t\\tvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\\n\\t\\t\\t\\t#else\\n\\t\\t\\t\\t\\tfloat spotDiffuseWeight = max( dotProduct, 0.0 );\\n\\t\\t\\t\\t#endif\\n\\n\\t\\t\\t\\tspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\\n\\t\\t\\t\\tvec3 spotHalfVector = normalize( lVector + viewPosition );\\n\\t\\t\\t\\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\\n\\t\\t\\t\\tfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t#ifdef PHYSICALLY_BASED_SHADING\\n\\t\\t\\t\\t\\tfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\\n\\t\\t\\t\\t\\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\\n\\t\\t\\t\\t\\tspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\\n\\t\\t\\t\\t#else\\n\\t\\t\\t\\t\\tspotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\\n\\t\\t\\t\\t#endif\\n\\t\\t\\t}\\n\\t\\t}\\n\\t#endif\\n\\n\\t#if MAX_DIR_LIGHTS > 0\\n\\t\\tvec3 dirDiffuse  = vec3( 0.0 );\\n\\t\\tvec3 dirSpecular = vec3( 0.0 );\\n\\t\\t\\n\\t\\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\t\\t\\tvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\\n\\t\\t\\tvec3 dirVector = normalize( lDirection.xyz );\\n\\t\\t\\tfloat dotProduct = dot( normal, dirVector );\\n\\t\\t\\t\\n\\t\\t\\t#ifdef WRAP_AROUND\\n\\t\\t\\t\\tfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\\n\\t\\t\\t\\tfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\\n\\t\\t\\t\\tvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tfloat dirDiffuseWeight = max( dotProduct, 0.0 );\\n\\t\\t\\t#endif\\n\\n\\t\\t\\tdirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\\n\\t\\t\\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\\n\\t\\t\\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\\n\\t\\t\\tfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\\n\\t\\t\\t\\n\\t\\t\\t#ifdef PHYSICALLY_BASED_SHADING\\n\\t\\t\\t\\tfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\\n\\t\\t\\t\\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\\n\\t\\t\\t\\tdirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\\n\\t\\t\\t#else\\n\\t\\t\\t\\tdirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\\n\\t\\t\\t#endif\\n\\t\\t}\\n\\t#endif\\n\\n\\t#if MAX_HEMI_LIGHTS > 0\\n\\t\\tvec3 hemiDiffuse  = vec3( 0.0 );\\n\\t\\tvec3 hemiSpecular = vec3( 0.0 );\\n\\t\\t\\n\\t\\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\t\\t\\tvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\\n\\t\\t\\tvec3 lVector = normalize( lDirection.xyz );\\n\\t\\t\\tfloat dotProduct = dot( normal, lVector );\\n\\t\\t\\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\t\\t\\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\t\\t\\themiDiffuse += diffuse * hemiColor;\\n\\t\\t\\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\\n\\t\\t\\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\\n\\t\\t\\tfloat hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\\n\\t\\t\\tvec3 lVectorGround = -lVector;\\n\\t\\t\\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\\n\\t\\t\\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\\n\\t\\t\\tfloat hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\\n\\t\\t\\t\\n\\t\\t\\t#ifdef PHYSICALLY_BASED_SHADING\\n\\t\\t\\t\\tfloat dotProductGround = dot( normal, lVectorGround );\\n\\t\\t\\t\\tfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\\n\\t\\t\\t\\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\\n\\t\\t\\t\\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\\n\\t\\t\\t\\themiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\\n\\t\\t\\t#else\\n\\t\\t\\t\\themiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\\n\\t\\t\\t#endif\\n\\t\\t}\\n\\t#endif\\n\\n\\tvec3 totalDiffuse = vec3( 0.0 );\\n\\tvec3 totalSpecular = vec3( 0.0 );\\n\\t#if MAX_DIR_LIGHTS > 0\\n\\t\\ttotalDiffuse += dirDiffuse;\\n\\t\\ttotalSpecular += dirSpecular;\\n\\t#endif\\n\\n\\t#if MAX_HEMI_LIGHTS > 0\\n\\t\\ttotalDiffuse += hemiDiffuse;\\n\\t\\ttotalSpecular += hemiSpecular;\\n\\t#endif\\n\\n\\t#if MAX_POINT_LIGHTS > 0\\n\\t\\ttotalDiffuse += pointDiffuse;\\n\\t\\ttotalSpecular += pointSpecular;\\n\\t#endif\\n\\n\\t#if MAX_SPOT_LIGHTS > 0\\n\\t\\ttotalDiffuse += spotDiffuse;\\n\\t\\ttotalSpecular += spotSpecular;\\n\\t#endif\\n\\n\\t#ifdef METAL\\n\\t\\tgl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor + totalSpecular );\\n\\t#else\\n\\t\\tgl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor ) + totalSpecular;\\n\\t#endif\\n\\n\\t#ifdef USE_COLOR\\n\\t\\tgl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\\n\\t#endif\\n\\n\\t#ifdef USE_FOG\\n\\t\\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\\n\\t\\t\\n\\t\\t#ifdef FOG_EXP2\\n\\t\\t\\tconst float LOG2 = 1.442695;\\n\\t\\t\\tfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\\n\\t\\t\\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\\n\\t\\t#else\\n\\t\\t\\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\\n\\t\\t#endif\\n\\n\\t\\tgl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\\n\\t#endif\\n}\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/materials/shaders/BookMaterial.fs\n ** module id = 10\n ** module chunks = 0\n **/","import BaseObject from './BaseObject';\n\nexport default class LibraryObject extends BaseObject {\n\tconstructor(params, geometry, material) {\n\t\tsuper(params, geometry, material);\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/models/LibraryObject.js\n **/","import BaseObject from './BaseObject';\n\nconst TYPE = 'BookObject';\n\nexport default class BookObject extends BaseObject {\t\n\tconstructor(dataObject, geometry, material) {\n\t\tsuper(dataObject, geometry, material);\n\t}\n\n\tstatic get TYPE() {\n\t\treturn TYPE;\n\t}\n\t\n\tget vbType() {\n\t\treturn TYPE;\n\t}\n\n\tgetDto() {\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\tuserId: this.dataObject.userId,\n\t\t\tpos_x: this.position.x,\n\t\t\tpos_y: this.position.y,\n\t\t\tpos_z: this.position.z\n\t\t};\n\t}\n\n\tsetParent(parent) {\n\t\tif(this.parent != parent) {\n\t\t\tif(parent) {\n\t\t\t\tparent.add(this);\n\t\t\t\tthis.dataObject.shelfId = parent.getId();\n\t\t\t\tthis.dataObject.sectionId = parent.parent.getId();\n\t\t\t} else {\n\t\t\t\tthis.parent.remove(this);\n\t\t\t\tthis.dataObject.shelfId = null;\n\t\t\t\tthis.dataObject.sectionId = null;\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/models/BookObject.js\n **/","import BaseObject from './BaseObject';\nimport ShelfObject from './ShelfObject';\n\nconst TYPE = 'SectionObject';\n\nexport default class SectionObject extends BaseObject {\n\tconstructor(params, geometry, material) {\n\t\tsuper(params, geometry, material);\n\n\t\tthis.shelves = {};\n\t\tfor(var key in params.data.shelves) {\n\t\t\tthis.shelves[key] = new ShelfObject(params.data.shelves[key]); \n\t\t\tthis.add(this.shelves[key]);\n\t\t}\n\t}\n\n\tstatic get TYPE() {\n\t\treturn TYPE;\n\t}\n\n\tget vbType() {\n\t\treturn TYPE;\n\t}\n\n\tgetDto() {\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\tuserId: this.dataObject.userId,\n\t\t\tpos_x: this.position.x,\n\t\t\tpos_y: this.position.y,\n\t\t\tpos_z: this.position.z,\n\t\t\trotation: [this.rotation.x, this.rotation.y, this.rotation.z]\n\t\t};\n\t}\n\n\tsetParent(parent) {\n\t\tif(this.parent != parent) {\n\t\t\tif(parent) {\n\t\t\t\tparent.add(this);\n\t\t\t\tthis.dataObject.libraryId = parent.getId();\n\t\t\t} else {\n\t\t\t\tthis.parent.remove(this);\n\t\t\t\tthis.dataObject.libraryId = null;\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/models/SectionObject.js\n **/","import THREE from 'three';\nimport BaseObject from './BaseObject';\n\nconst TYPE = 'ShelfObject';\n\nexport default class ShelfObject extends BaseObject {\n\tconstructor(params) {\n\t\tvar size = params.size;\t\n\t\tvar geometry = new THREE.BoxGeometry(size[0], size[1], size[2]);\n\n\t\tgeometry.computeBoundingBox();\n\t\tsuper(params, geometry);\n\n\t\tthis.position.set(params.position[0], params.position[1], params.position[2]);\n\t\tthis.size = new THREE.Vector3(size[0], size[1], size[2]);\n\t\t\n\t\tthis.material.transparent = true;\n\t\tthis.material.opacity = 0;\n\t}\n\n\tget vbType() {\n\t\treturn TYPE;\n\t}\n\n\tstatic get TYPE() {\n\t\treturn TYPE;\n\t}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/models/ShelfObject.js\n **/","import THREE from 'three';\n\nimport CameraObject from './models/CameraObject';\n\nvar camera = {\n\tHEIGTH: 1.5,\n\tobject: new CameraObject(),\n\tsetParent: function(parent) {\n\t\tparent.add(this.object);\n\t},\n\tgetPosition: function() {\n\t\treturn this.object.position;\n\t}\n};\n\nvar init = function(width, height) {\t\n\tcamera.camera = new THREE.PerspectiveCamera(45, width / height, 0.01, 50);\n\tcamera.object.position.set(0, camera.HEIGTH, 0);\n\tcamera.object.rotation.order = 'YXZ';\n\n\tvar candle = new THREE.PointLight(0x665555, 1.6, 10);\n\tcandle.position.set(0, 0, 0);\n\n\tcamera.object.add(candle);\n\tcamera.object.add(camera.camera);\n};\n\ncamera.rotate = function(x, y) {\n\tvar newX = this.object.rotation.x + y * 0.0001 || 0;\n\tvar newY = this.object.rotation.y + x * 0.0001 || 0;\n\n\tif(newX < 1.57 && newX > -1.57) {\t\n\t\tthis.object.rotation.x = newX;\n\t}\n\n\tthis.object.rotation.y = newY;\n};\n\ncamera.go = function(speed) {\n\tvar direction = this.getVector();\n\tvar newPosition = this.object.position.clone();\n\tnewPosition.add(direction.multiplyScalar(speed));\n\n\tthis.object.move(newPosition);\n};\n\ncamera.getVector = function() {\n\tvar vector = new THREE.Vector3(0, 0, -1);\n\n\treturn vector.applyEuler(this.object.rotation);\n};\n\ninit(1024, 768);\n\nexport default camera;\n\n\n/** WEBPACK FOOTER **\n ** ./src/camera.js\n **/","import THREE from 'three';\nimport BaseObject from './BaseObject';\n\nexport default class CameraObject extends BaseObject {\n\tconstructor() {\n\t\tvar geometry = new THREE.Geometry();\n\t\tgeometry.boundingBox = new THREE.Box3(\n\t\t\tnew THREE.Vector3(-0.1, -1, -0.1), \n\t\t\tnew THREE.Vector3(0.1, 1, 0.1)\n\t\t);\n\n\t\tsuper(null, geometry);\n\t}\n\t\n\tupdateBoundingBox() {\n\t\tvar radius = {\n\t\t\tx: this.geometry.boundingBox.max.x, \n\t\t\ty: this.geometry.boundingBox.max.y, \n\t\t\tz: this.geometry.boundingBox.max.z\n\t\t};\n\n\t\tthis.boundingBox = {\n\t\t\tradius: radius,\n\t\t\tcenter: this.position //TODO: needs center of section in parent or world coordinates\n\t\t};\n\t}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/models/CameraObject.js\n **/","import THREE from 'three';\n\nimport camera from './camera';\n\nexport var mouse = {};\n\nfunction getWidth() {\n\treturn window.innerWidth;\n}\n\nfunction getHeight() {\n\treturn window.innerHeight;\n}\n\nvar x = null;\nvar y = null;\n\nmouse.target = null;\nmouse.dX = null;\nmouse.dY = null;\nmouse.longX = null;\nmouse.longY = null;\n\nmouse.getTarget = function() {\n\treturn this.target;\n};\n\nmouse.down = function(event) {\n\tif(event) {\n\t\tthis[event.which] = true;\n\t\tthis.target = event.target;\n\t\tx = event.clientX;\n\t\ty = event.clientY;\n\t\tmouse.longX = getWidth() * 0.5 - x;\n\t\tmouse.longY = getHeight() * 0.5 - y;\n\t}\n};\n\nmouse.up = function(event) {\n\tif(event) {\n\t\tthis[event.which] = false;\n\t\t// linux chrome bug fix (when both keys release then both event.which equal 3)\n\t\tthis[1] = false; \n\t}\n};\n\nmouse.move = function(event) {\n\tif(event) {\n\t\tthis.target = event.target;\n\t\tmouse.longX = getWidth() * 0.5 - x;\n\t\tmouse.longY = getHeight() * 0.5 - y;\n\t\tmouse.dX = event.clientX - x;\n\t\tmouse.dY = event.clientY - y;\n\t\tx = event.clientX;\n\t\ty = event.clientY;\n\t}\n};\n\nmouse.getIntersected = function(objects, recursive, searchFor) {\n\tvar\n\t\tvector,\n\t\traycaster,\n\t\tintersects,\n\t\tintersected,\n\t\tresult,\n\t\ti, j;\n\n\tresult = null;\n\tvector = getVector();\n\traycaster = new THREE.Raycaster();\n\traycaster.set(camera.getPosition(), vector);\n\tintersects = raycaster.intersectObjects(objects, recursive);\n\n\tif(searchFor) {\n\t\tif(intersects.length) {\n\t\t\tfor(i = 0; i < intersects.length; i++) {\n\t\t\t\tintersected = intersects[i];\n\t\t\t\t\n\t\t\t\tfor(j = searchFor.length - 1; j >= 0; j--) {\n\t\t\t\t\tif(intersected.object instanceof searchFor[j]) {\n\t\t\t\t\t\tresult = intersected;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(result) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\t\t\n\t} else {\n\t\tresult = intersects;\n\t}\n\n\treturn result;\n};\n\nfunction getVector() {\n\tvar vector = new THREE.Vector3((x / getWidth()) * 2 - 1, - (y / getHeight()) * 2 + 1, 0.5);\n\tvector.unproject(camera.camera);\n\n\treturn vector.sub(camera.getPosition()).normalize();\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/mouse.js\n **/","import THREE from 'three';\n\nimport camera from './camera';\nimport highlight from './highlight';\n\nexport var preview = {};\n\nvar active = false;\nvar container;\n\nfunction init() {\n\tcontainer = new THREE.Object3D();\n\tcontainer.position.set(0, 0, -0.5);\n\tcontainer.rotation.y = -2;\n\tcamera.camera.add(container);\n}\n\nfunction activate(value) {\n\tactive = value;\n\thighlight.enable(!active);\n}\n\npreview.isActive = function() {\n\treturn active;\n};\n\npreview.enable = function(obj) {\n\tvar objClone;\n\n\tif(obj) {\n\t\tactivate(true);\n\n\t\tobjClone = obj.clone();\n\t\tobjClone.position.set(0, 0, 0);\n\t\tcontainer.add(objClone);\n\t}\n};\n\npreview.disable = function () {\n\tclearContainer();\n\tactivate(false);\n};\n\nfunction clearContainer() {\n\tcontainer.children.forEach(function (child) {\n\t\tcontainer.remove(child);\n\t});\n}\n\npreview.rotate = function(dX) {\n\tcontainer.rotation.y += dX ? dX * 0.05 : 0;\n};\n\ninit();\n\n\n/** WEBPACK FOOTER **\n ** ./src/preview.js\n **/","import THREE from 'three';\n\nimport environment from './environment';\n\nvar highlight = {};\n\nvar PLANE_ROTATION = Math.PI * 0.5;\nvar PLANE_MULTIPLIER = 2;\nvar COLOR_SELECT = 0x005533;\nvar COLOR_FOCUS = 0x003355;\n\nvar selectPlane;\nvar focusPlane;\n\nvar init = function() {\n\tvar materialProperties = {\n\t\tmap: new THREE.ImageUtils.loadTexture(require('./img/glow.png')),\n\t\ttransparent: true, \n\t\tside: THREE.DoubleSide,\n\t\tblending: THREE.AdditiveBlending,\n\t\tdepthTest: false\n\t};\n\n\tmaterialProperties.color = COLOR_SELECT;\n\tvar materialSelect = new THREE.MeshBasicMaterial(materialProperties);\n\n\tmaterialProperties.color = COLOR_FOCUS;\n\tvar materialFocus = new THREE.MeshBasicMaterial(materialProperties);\n\n\tvar geometry = new THREE.PlaneBufferGeometry(1, 1, 1);\n\n\tselectPlane = new THREE.Mesh(geometry, materialSelect);\n\tselectPlane.rotation.x = PLANE_ROTATION;\n\n\tfocusPlane = new THREE.Mesh(geometry, materialFocus);\n\tfocusPlane.rotation.x = PLANE_ROTATION;\n};\n\nvar commonHighlight = function(which, obj) {\n\tif(obj) {\n\t\tvar width = obj.geometry.boundingBox.max.x * PLANE_MULTIPLIER;\n\t\tvar height = obj.geometry.boundingBox.max.z * PLANE_MULTIPLIER;\n\t\tvar bottom = obj.geometry.boundingBox.min.y + environment.CLEARANCE;\n\t\t\n\t\twhich.position.y = bottom;\n\t\twhich.scale.set(width, height, 1);\n\t\tobj.add(which);\n\n\t\twhich.visible = true;\n\t} else {\n\t\twhich.visible = false;\n\t}\n};\n\nhighlight.enable = function(enable) {\n\tfocusPlane.visible = selectPlane.visible = enable;\n};\n\nhighlight.focus = function(obj) {\n\tcommonHighlight(focusPlane, obj);\n};\n\nhighlight.select = function(obj) {\n\tcommonHighlight(selectPlane, obj);\n};\n\ninit();\n\nexport default highlight;\n\n\n/** WEBPACK FOOTER **\n ** ./src/highlight.js\n **/","module.exports = \"data:image/png;base64,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\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/img/glow.png\n ** module id = 20\n ** module chunks = 0\n **/","import SelectorMeta from './models/SelectorMeta';\nimport ShelfObject from './models/ShelfObject';\nimport BookObject from './models/BookObject';\nimport SectionObject from './models/SectionObject';\n\nimport environment from './environment';\nimport highlight from './highlight';\nimport {preview} from './preview';\n\nexport var selector = {};\n\nvar selected = new SelectorMeta();\nvar focused = new SelectorMeta();\n\nselector.placing = false;\n\nselector.getSelectedId = function() {\n\treturn selected.id;\n};\n\nselector.focus = function(meta) {\n\tvar obj;\n\n\tif(!meta.equals(focused)) {\n\t\tfocused = meta;\n\n\t\tif(!focused.isEmpty()) {\n\t\t\tobj = selector.getFocusedObject();\n\t\t\thighlight.focus(obj);\n\t\t}\n\t}\n};\n\nselector.selectFocused = function() {\n\tselector.select(focused);\n};\n\nselector.select = function(meta) {\n\tvar obj = getObject(meta);\n\t\n\tselector.unselect();\n\tselected = meta;\n\n\thighlight.select(obj);\n\thighlight.focus(null);\n\n\tselector.placing = false;\n};\n\nselector.unselect = function() {\n\tif(!selected.isEmpty()) {\n\t\thighlight.select(null);\n\t\tselected = new SelectorMeta();\n\t}\n\n\tpreview.disable();\n};\n\nselector.getSelectedObject = function() {\n\treturn getObject(selected);\n};\n\nselector.getFocusedObject = function() {\n\treturn getObject(focused);\n};\n\nfunction getObject(meta) {\n\tvar object;\n\n\tif(!meta.isEmpty()) {\n\t\tobject = isShelf(meta) ? environment.getShelf(meta.parentId, meta.id)\n\t\t\t: isBook(meta) ? environment.getBook(meta.id)\n\t\t\t: isSection(meta) ? environment.getSection(meta.id)\n\t\t\t: null;\n\t}\n\n\treturn object;\t\n}\n\nselector.isSelectedEditable = function() {\n\treturn selector.isSelectedBook() || selector.isSelectedSection();\n};\n\nselector.isBookSelected = function(id) {\n\treturn isBook(selected) && selected.id === id;\n};\n\nselector.isSelectedShelf = function() {\n\treturn isShelf(selected);\n};\n\nselector.isSelectedBook = function() {\n\treturn isBook(selected);\n};\n\nselector.isSelectedSection = function() {\n\treturn isSection(selected);\n};\n\nfunction isShelf(meta) {\n\treturn meta.type === ShelfObject.TYPE;\n}\n\nfunction isBook(meta) {\n\treturn meta.type === BookObject.TYPE;\n}\n\nfunction isSection(meta) {\n\treturn meta.type === SectionObject.TYPE;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/selector.js\n **/","export default class SelectorMeta {\n\tconstructor(selectedObject) {\n\t\tif(selectedObject) {\n\t\t\tthis.id = selectedObject.getId();\n\t\t\tthis.parentId = selectedObject.parent.getId();\n\t\t\tthis.type = selectedObject.getType();\n\t\t}\n\t}\n\n\tisEmpty() {\n\t\treturn !this.id;\n\t}\n\n\tequals(meta) {\n\t\treturn !(!meta || \n\t\t\t\tmeta.id !== this.id || \n\t\t\t\tmeta.parentId !== this.parentId || \n\t\t\t\tmeta.type !== this.type);\n\t}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/models/SelectorMeta.js\n **/","import camera from './camera';\n\nexport var navigation = {};\n\nnavigation.BUTTONS_ROTATE_SPEED = 100;\nnavigation.BUTTONS_GO_SPEED = 0.02;\n\nvar state = {\n\tforward: false,\n\tbackward: false,\n\tleft: false,\n\tright: false\t\t\t\n};\n\nnavigation.goStop = function() {\n\tstate.forward = false;\n\tstate.backward = false;\n\tstate.left = false;\n\tstate.right = false;\n};\n\nnavigation.goForward = function() {\n\tstate.forward = true;\n};\n\nnavigation.goBackward = function() {\n\tstate.backward = true;\n};\n\nnavigation.goLeft = function() {\n\tstate.left = true;\n};\n\nnavigation.goRight = function() {\n\tstate.right = true;\n};\n\nnavigation.update = function() {\n\tif(state.forward) {\n\t\tcamera.go(navigation.BUTTONS_GO_SPEED);\n\t} else if(state.backward) {\n\t\tcamera.go(-navigation.BUTTONS_GO_SPEED);\n\t} else if(state.left) {\n\t\tcamera.rotate(navigation.BUTTONS_ROTATE_SPEED, 0);\n\t} else if(state.right) {\n\t\tcamera.rotate(-navigation.BUTTONS_ROTATE_SPEED, 0);\n\t}\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/navigation.js\n **/","import SelectorMeta from './SelectorMeta';\n\nexport default class SelectorMetaDto extends SelectorMeta {\n\tconstructor(type, id, parentId) {\n\t\tsuper();\n\t\t\n\t\tthis.type = type;\n\t\tthis.id = id;\n\t\tthis.parentId = parentId;\n\t}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/models/SelectorMetaDto.js\n **/"],"sourceRoot":""}