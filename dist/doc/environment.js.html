<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: environment.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: environment.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @module environment
 * @description Main module, contains all the root entities
 */
import THREE from 'three';

import * as camera from './camera';
import * as locator from './locator';
import * as loader from './loader';

export var library = null;
export var renderer;
export var scene;

var loops = [];

/**
 * Inits lib3d, should be called first, use canvas with padding: 0
 * @param {canvas} canvas - chould be provided for lib3d output
 * @param {Number} width - viewport width
 * @param {Number} height- viewport height
 */
export function init(canvas, width, height) {
    scene = new THREE.Scene();
    scene.fog = new THREE.Fog(0x000000, 4, 7);
    renderer = new THREE.WebGLRenderer({canvas: canvas || undefined, antialias: true});
    renderer.setSize(width, height);
    camera.setSize(width, height);

    startRenderLoop();
}

/**
 * Adds function to render loop
 * @param {function} func - function will be called on every render call
 */
export function addLoop(func) {
    loops.push(func);
}

export function setLibrary(newLibrary) {
    library = newLibrary;

    scene.add(library);
    camera.setParent(library);
    locator.centerObject(camera.object);
}

function startRenderLoop() {
    requestAnimationFrame(startRenderLoop);
    renderer.render(scene, camera.camera);

    loops.forEach(func => func());
}

/** Recreates section with new parameters if it has libraryId
 * or removes it if has not
 * @param {Object} dto - Section dto
 * @returns {Promise} Resolves with section dto
 */
// export function updateSection(dto) {
//     if(dto.libraryId == library.getId()) {
//         library.removeSection(dto.id);
//         return createSection(dto);
//     } else {
//         library.removeSection(dto.id);
//         return Promise.resolve(dto);
//     }
// }

/** Recreates book with new parameters if there is appropriate shelf
 * or removes it if shelf is not presented in book or doesn't exist on the scene
 * @param {Object} dto - Book dto
 * @returns {Promise} Resolves with book dto if placed or true if removed
 */
// export function updateBook(dto) {
//     if(library.getBookShelf(dto)) {
//         library.removeBook(dto.id);
//         return createBook(dto);
//     } else {
//         library.removeBook(dto.id);
//         return Promise.resolve(true);
//     }
// }</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-camera.html">camera</a></li><li><a href="module-environment.html">environment</a></li><li><a href="module-factory.html">factory</a></li><li><a href="module-lib3d.html">lib3d</a></li><li><a href="module-loader.html">loader</a></li><li><a href="module-locator.html">locator</a></li><li><a href="module-mouse.html">mouse</a></li><li><a href="module-navigation.html">navigation</a></li><li><a href="module-preview.html">preview</a></li><li><a href="module-selector.html">selector</a></li></ul><h3>Global</h3><ul><li><a href="global.html#CLEARANCE">CLEARANCE</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Tue Feb 02 2016 12:18:16 GMT+0300 (Belarus Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
